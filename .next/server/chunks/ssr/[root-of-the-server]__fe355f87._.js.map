{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":["file:///Users/silsmaria/Projects/mathview/components/mathview/Logic/nodeUtils.ts"],"sourcesContent":["import { Node, Row, Symbol, Fraction, Cursor } from '../Types'\n\nconst indent = (str: string, level: number) => {\n    return '  '.repeat(level) + str\n}\n\nconst formatNode = (node: Node, level: number = 0): string => {\n    switch (node.type) {\n        case 'row':\n            return formatRow(node as Row, level)\n        case 'symbol':\n            return formatSymbol(node as Symbol, level)\n        case 'fraction':\n            return formatFraction(node as Fraction, level)\n        case 'cursor':\n            return formatCursor(node as Cursor, level)\n        default:\n            return indent(`Unknown node type: ${(node as any).type}`, level)\n    }\n}\n\nconst formatRow = (row: Row, level: number): string => {\n    const lines = [\n        indent(`Row(id: ${row.id})`, level),\n        indent('children:', level)\n    ]\n\n    row.children.forEach(child => {\n        lines.push(formatNode(child, level + 1))\n    })\n\n    return lines.join('\\n')\n}\n\nconst formatSymbol = (symbol: Symbol, level: number): string => {\n    return indent(`Symbol(id: ${symbol.id}, value: \"${symbol.value}\")`, level)\n}\n\nconst formatFraction = (fraction: Fraction, level: number): string => {\n    const lines = [\n        indent(`Fraction(id: ${fraction.id})`, level),\n        indent('numerator:', level)\n    ]\n    lines.push(formatNode(fraction.numerator, level + 1))\n    lines.push(indent('denominator:', level))\n    lines.push(formatNode(fraction.denominator, level + 1))\n    return lines.join('\\n')\n}\n\nconst formatCursor = (cursor: Cursor, level: number): string => {\n    return indent(`Cursor(id: ${cursor.id})`, level)\n}\n\nexport const logNode = (node: Node) => {\n    console.log('\\nNode Structure:')\n    console.log(formatNode(node))\n    console.log('\\n')\n}\n\nexport const logNodeTree = (root: Node) => {\n    console.log('\\nNode Tree:')\n    console.log(formatNode(root))\n    console.log('\\n')\n} "],"names":[],"mappings":";;;;AAEA,MAAM,SAAS,CAAC,KAAa;IACzB,OAAO,KAAK,MAAM,CAAC,SAAS;AAChC;AAEA,MAAM,aAAa,CAAC,MAAY,QAAgB,CAAC;IAC7C,OAAQ,KAAK,IAAI;QACb,KAAK;YACD,OAAO,UAAU,MAAa;QAClC,KAAK;YACD,OAAO,aAAa,MAAgB;QACxC,KAAK;YACD,OAAO,eAAe,MAAkB;QAC5C,KAAK;YACD,OAAO,aAAa,MAAgB;QACxC;YACI,OAAO,OAAO,CAAC,mBAAmB,EAAE,AAAC,KAAa,IAAI,EAAE,EAAE;IAClE;AACJ;AAEA,MAAM,YAAY,CAAC,KAAU;IACzB,MAAM,QAAQ;QACV,OAAO,CAAC,QAAQ,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC,EAAE;QAC7B,OAAO,aAAa;KACvB;IAED,IAAI,QAAQ,CAAC,OAAO,CAAC,CAAA;QACjB,MAAM,IAAI,CAAC,WAAW,OAAO,QAAQ;IACzC;IAEA,OAAO,MAAM,IAAI,CAAC;AACtB;AAEA,MAAM,eAAe,CAAC,QAAgB;IAClC,OAAO,OAAO,CAAC,WAAW,EAAE,OAAO,EAAE,CAAC,UAAU,EAAE,OAAO,KAAK,CAAC,EAAE,CAAC,EAAE;AACxE;AAEA,MAAM,iBAAiB,CAAC,UAAoB;IACxC,MAAM,QAAQ;QACV,OAAO,CAAC,aAAa,EAAE,SAAS,EAAE,CAAC,CAAC,CAAC,EAAE;QACvC,OAAO,cAAc;KACxB;IACD,MAAM,IAAI,CAAC,WAAW,SAAS,SAAS,EAAE,QAAQ;IAClD,MAAM,IAAI,CAAC,OAAO,gBAAgB;IAClC,MAAM,IAAI,CAAC,WAAW,SAAS,WAAW,EAAE,QAAQ;IACpD,OAAO,MAAM,IAAI,CAAC;AACtB;AAEA,MAAM,eAAe,CAAC,QAAgB;IAClC,OAAO,OAAO,CAAC,WAAW,EAAE,OAAO,EAAE,CAAC,CAAC,CAAC,EAAE;AAC9C;AAEO,MAAM,UAAU,CAAC;IACpB,QAAQ,GAAG,CAAC;IACZ,QAAQ,GAAG,CAAC,WAAW;IACvB,QAAQ,GAAG,CAAC;AAChB;AAEO,MAAM,cAAc,CAAC;IACxB,QAAQ,GAAG,CAAC;IACZ,QAAQ,GAAG,CAAC,WAAW;IACvB,QAAQ,GAAG,CAAC;AAChB","debugId":null}},
    {"offset": {"line": 78, "column": 0}, "map": {"version":3,"sources":["file:///Users/silsmaria/Projects/mathview/components/mathview/Logic/helperFunctons.ts"],"sourcesContent":["import { Cursor, Node, Row } from '../Types'\n\nexport const getIndex = (node: Node): number => {\n    if (!node.parent) {\n        return 0\n    }\n\n    // Find the index of the cursor in its parent's children\n    return node.parent.children.findIndex(child => child.id === node.id)\n}\n\nexport const insertNode = (node: Node, cursor: Cursor) => {\n    const index = getIndex(cursor)\n    cursor.parent.children.splice(index, 0, node)\n}\n\n// function to get node to left and right of input node\nexport const getAdjacentNodes = (node: Node): { left: Node | null, right: Node | null } => {\n    if (!node.parent) {\n        return { left: null, right: null }\n    }\n\n    const index = getIndex(node as Cursor)\n    const children = node.parent.children\n\n    return {\n        left: index > 0 ? children[index - 1] : null,\n        right: index < children.length - 1 ? children[index + 1] : null\n    }\n}\n\nexport const moveNode = (node: Node, newParent: Row, index: number) => {\n    // Remove node from its current parent\n    if (node.parent) {\n        const oldChildren = node.parent.children\n        const oldIndex = oldChildren.findIndex(child => child.id === node.id)\n        if (oldIndex !== -1) {\n            oldChildren.splice(oldIndex, 1)\n        }\n    }\n\n    // Set new parent\n    node.parent = newParent\n\n    // Insert node into new parent's children at the specified index\n    newParent.children.splice(index, 0, node)\n}\n"],"names":[],"mappings":";;;;;;AAEO,MAAM,WAAW,CAAC;IACrB,IAAI,CAAC,KAAK,MAAM,EAAE;QACd,OAAO;IACX;IAEA,wDAAwD;IACxD,OAAO,KAAK,MAAM,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAA,QAAS,MAAM,EAAE,KAAK,KAAK,EAAE;AACvE;AAEO,MAAM,aAAa,CAAC,MAAY;IACnC,MAAM,QAAQ,SAAS;IACvB,OAAO,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,OAAO,GAAG;AAC5C;AAGO,MAAM,mBAAmB,CAAC;IAC7B,IAAI,CAAC,KAAK,MAAM,EAAE;QACd,OAAO;YAAE,MAAM;YAAM,OAAO;QAAK;IACrC;IAEA,MAAM,QAAQ,SAAS;IACvB,MAAM,WAAW,KAAK,MAAM,CAAC,QAAQ;IAErC,OAAO;QACH,MAAM,QAAQ,IAAI,QAAQ,CAAC,QAAQ,EAAE,GAAG;QACxC,OAAO,QAAQ,SAAS,MAAM,GAAG,IAAI,QAAQ,CAAC,QAAQ,EAAE,GAAG;IAC/D;AACJ;AAEO,MAAM,WAAW,CAAC,MAAY,WAAgB;IACjD,sCAAsC;IACtC,IAAI,KAAK,MAAM,EAAE;QACb,MAAM,cAAc,KAAK,MAAM,CAAC,QAAQ;QACxC,MAAM,WAAW,YAAY,SAAS,CAAC,CAAA,QAAS,MAAM,EAAE,KAAK,KAAK,EAAE;QACpE,IAAI,aAAa,CAAC,GAAG;YACjB,YAAY,MAAM,CAAC,UAAU;QACjC;IACJ;IAEA,iBAAiB;IACjB,KAAK,MAAM,GAAG;IAEd,gEAAgE;IAChE,UAAU,QAAQ,CAAC,MAAM,CAAC,OAAO,GAAG;AACxC","debugId":null}},
    {"offset": {"line": 129, "column": 0}, "map": {"version":3,"sources":["file:///Users/silsmaria/Projects/mathview/components/mathview/Logic/edit.ts"],"sourcesContent":["import { Cursor, Exponent, Fraction, Row, Symbol } from '../Types'\nimport { getAdjacentNodes, getIndex, insertNode, moveNode } from './helperFunctons'\nimport { createId } from '../MathEditor'\n\n\n// Handle basic symbol insertion (+, -, *, /)\nexport const insertSymbol = (input: string, cursor: Cursor) => {\n    // TODO: Implement symbol insertion logic\n    const symbolNode: Symbol = {\n        type: 'symbol',\n        value: input,\n        parent: cursor.parent,\n        id: createId()\n    }\n\n    console.log('Inserting symbol:', input, symbolNode.id)\n    insertNode(symbolNode, cursor)\n}\n\n\nexport const insertExponent = (input: string, cursor: Cursor) => {\n    const baseNode: Row = {\n        type: 'row',\n        children: [],\n        parent: cursor.parent,\n        id: createId()\n    }\n    const raisedNode: Row = {\n        type: 'row',\n        children: [],\n        parent: cursor.parent,\n        id: createId()\n    }\n    const exponentNode: Exponent = {\n        type: 'exponent',\n        base: baseNode,\n        raised: raisedNode,\n        parent: cursor.parent,\n        id: createId()\n    }\n    moveNode(getAdjacentNodes(cursor).left,baseNode,0)\n    insertNode(exponentNode,cursor)\n    moveNode(cursor,raisedNode,1)\n}\n\n\n// Handle fraction insertion\nexport const insertFraction = (cursor: Cursor) => {\n    // TODO: Implement fraction insertion logic\n    // console.log('Left:', left)\n    // console.log('Right:', right)\n\n    const fractionNode: Fraction = {\n        type: 'fraction',\n        numerator: null,\n        denominator: null,\n        parent: cursor.parent,\n        id: createId()\n    }\n    const numeratorNode: Row = {\n        type: 'row',\n        children: [],\n        parent: fractionNode,\n        id: createId()\n    }\n    const denominatorNode: Row = {\n        type: 'row',\n        children: [],\n        parent: fractionNode,\n        id: createId()\n    }\n    fractionNode.numerator = numeratorNode\n    fractionNode.denominator = denominatorNode\n\n    const cursorIndex = getIndex(cursor)\n    let leftIndex = cursorIndex - 1\n\n    // Move all consecutive number nodes to the left of the cursor into the numerator node\n\n    const left = getAdjacentNodes(cursor).left;\n    if (left.type === 'symbol'){\n        const siblings = cursor.parent.children\n\n        // Collect indices of consecutive number nodes to the left\n        const numbers: Symbol[] = []\n        while (leftIndex >= 0) {\n            const node = siblings[leftIndex]\n            if (node.type === 'symbol' && typeof node.value === 'string' && /^[0-9]$/.test(node.value)) {\n                numbers.unshift(node) // unshift to preserve order\n                leftIndex--\n            } else {\n                break\n            }\n        }\n\n        // Move each number node into the numerator node\n        console.log('Number indices:', numbers)\n        for (let i = 0; i < numbers.length; i++) {\n            const numberNode = numbers[i]\n            moveNode(numberNode, numeratorNode, numeratorNode.children.length)\n        }\n\n    moveNode(fractionNode, cursor.parent, cursorIndex)\n    moveNode(cursor, denominatorNode, 0)\n    }\n\n    else if (left.type === 'fraction'){\n        console.log('Left is a fraction')\n    moveNode(fractionNode, cursor.parent, cursorIndex)\n        moveNode(left,numeratorNode,0)\n        moveNode(cursor, denominatorNode, 0)\n    }\n\n}\n\n\n\n// Handle deletion\nexport const deleteAtCursor = (cursor: Cursor) => {\n    // TODO: Implement deletion logic\n    console.log('Deleting at cursor')\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 242, "column": 0}, "map": {"version":3,"sources":["file:///Users/silsmaria/Projects/mathview/components/mathview/Logic/navigation.ts"],"sourcesContent":["import { Cursor } from '../Types'\nimport { getAdjacentNodes, getIndex, moveNode } from './helperFunctons'\n\nexport const moveLeft = (cursor: Cursor, setCursor: (cursor: Cursor) => void) => {\n    const currentIndex = getIndex(cursor)\n    const left = getAdjacentNodes(cursor).left;\n    if (currentIndex > 0) {\n        if (left.type === 'fraction') {\n            moveNode(cursor, left.numerator , left.numerator.children.length);\n            setCursor({ ...cursor })\n        }\n        else{ // left is not a fraction\n        // Move cursor one position left\n        cursor.parent.children.splice(currentIndex - 1, 0, cursor)\n        cursor.parent.children.splice(currentIndex + 1, 1)\n        setCursor({ ...cursor })\n        }\n    }\n    else if (cursor.parent.id === 'root' && left === null) {\n        // At the leftmost boundary of the root node\n        const event = new CustomEvent('math-navigate-left', {\n            detail: { nodeKey: (window as any).currentMathNodeKey }\n        });\n        document.dispatchEvent(event);\n    }\n    else if (cursor.parent.parent.type === 'fraction') {\n        const fracindex = getIndex(cursor.parent.parent);\n        moveNode(cursor, cursor.parent.parent.parent, fracindex-1);\n        setCursor({ ...cursor })\n    }\n}\n\nexport const moveRight = (cursor: Cursor, setCursor: (cursor: Cursor) => void) => {\n    const currentIndex = getIndex(cursor);\n    const right = getAdjacentNodes(cursor).right;\n    if (currentIndex < cursor.parent.children.length - 1) {\n        if (right.type === 'fraction') {\n            moveNode(cursor, right.numerator, 0);\n            setCursor({ ...cursor })\n        }\n        else{ // right is not a fraction\n        // Move cursor one position right\n        cursor.parent.children.splice(currentIndex + 2, 0, cursor)\n        cursor.parent.children.splice(currentIndex, 1)\n        setCursor({ ...cursor })\n        }\n    }\n     if (cursor.parent.id === 'root' && right === null) {\n        console.log(\"RIGHT IS NULL\");\n        // At the rightmost boundary of the root node\n        const event = new CustomEvent('math-navigate-right', {\n            detail: { nodeKey: (window as any).currentMathNodeKey }\n        });\n        document.dispatchEvent(event);\n    }\n    else if (cursor.parent.parent.type === 'fraction') { // at the end of the fraction, move to the parent\n        const fracindex = getIndex(cursor.parent.parent);\n        moveNode(cursor, cursor.parent.parent.parent, fracindex+1);\n        setCursor({ ...cursor })\n    }\n}\n\nexport const moveUp = (cursor: Cursor, setCursor: (cursor: Cursor) => void) => {\n    // TODO: Implement vertical navigation\n    console.log('Move up')\n}\n\nexport const moveDown = (cursor: Cursor, setCursor: (cursor: Cursor) => void) => {\n    // TODO: Implement vertical navigation\n    console.log('Move down')\n}\n"],"names":[],"mappings":";;;;;;AACA;;AAEO,MAAM,WAAW,CAAC,QAAgB;IACrC,MAAM,eAAe,CAAA,GAAA,iJAAA,CAAA,WAAQ,AAAD,EAAE;IAC9B,MAAM,OAAO,CAAA,GAAA,iJAAA,CAAA,mBAAgB,AAAD,EAAE,QAAQ,IAAI;IAC1C,IAAI,eAAe,GAAG;QAClB,IAAI,KAAK,IAAI,KAAK,YAAY;YAC1B,CAAA,GAAA,iJAAA,CAAA,WAAQ,AAAD,EAAE,QAAQ,KAAK,SAAS,EAAG,KAAK,SAAS,CAAC,QAAQ,CAAC,MAAM;YAChE,UAAU;gBAAE,GAAG,MAAM;YAAC;QAC1B,OACI;YACJ,gCAAgC;YAChC,OAAO,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,eAAe,GAAG,GAAG;YACnD,OAAO,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,eAAe,GAAG;YAChD,UAAU;gBAAE,GAAG,MAAM;YAAC;QACtB;IACJ,OACK,IAAI,OAAO,MAAM,CAAC,EAAE,KAAK,UAAU,SAAS,MAAM;QACnD,4CAA4C;QAC5C,MAAM,QAAQ,IAAI,YAAY,sBAAsB;YAChD,QAAQ;gBAAE,SAAS,AAAC,OAAe,kBAAkB;YAAC;QAC1D;QACA,SAAS,aAAa,CAAC;IAC3B,OACK,IAAI,OAAO,MAAM,CAAC,MAAM,CAAC,IAAI,KAAK,YAAY;QAC/C,MAAM,YAAY,CAAA,GAAA,iJAAA,CAAA,WAAQ,AAAD,EAAE,OAAO,MAAM,CAAC,MAAM;QAC/C,CAAA,GAAA,iJAAA,CAAA,WAAQ,AAAD,EAAE,QAAQ,OAAO,MAAM,CAAC,MAAM,CAAC,MAAM,EAAE,YAAU;QACxD,UAAU;YAAE,GAAG,MAAM;QAAC;IAC1B;AACJ;AAEO,MAAM,YAAY,CAAC,QAAgB;IACtC,MAAM,eAAe,CAAA,GAAA,iJAAA,CAAA,WAAQ,AAAD,EAAE;IAC9B,MAAM,QAAQ,CAAA,GAAA,iJAAA,CAAA,mBAAgB,AAAD,EAAE,QAAQ,KAAK;IAC5C,IAAI,eAAe,OAAO,MAAM,CAAC,QAAQ,CAAC,MAAM,GAAG,GAAG;QAClD,IAAI,MAAM,IAAI,KAAK,YAAY;YAC3B,CAAA,GAAA,iJAAA,CAAA,WAAQ,AAAD,EAAE,QAAQ,MAAM,SAAS,EAAE;YAClC,UAAU;gBAAE,GAAG,MAAM;YAAC;QAC1B,OACI;YACJ,iCAAiC;YACjC,OAAO,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,eAAe,GAAG,GAAG;YACnD,OAAO,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,cAAc;YAC5C,UAAU;gBAAE,GAAG,MAAM;YAAC;QACtB;IACJ;IACC,IAAI,OAAO,MAAM,CAAC,EAAE,KAAK,UAAU,UAAU,MAAM;QAChD,QAAQ,GAAG,CAAC;QACZ,6CAA6C;QAC7C,MAAM,QAAQ,IAAI,YAAY,uBAAuB;YACjD,QAAQ;gBAAE,SAAS,AAAC,OAAe,kBAAkB;YAAC;QAC1D;QACA,SAAS,aAAa,CAAC;IAC3B,OACK,IAAI,OAAO,MAAM,CAAC,MAAM,CAAC,IAAI,KAAK,YAAY;QAC/C,MAAM,YAAY,CAAA,GAAA,iJAAA,CAAA,WAAQ,AAAD,EAAE,OAAO,MAAM,CAAC,MAAM;QAC/C,CAAA,GAAA,iJAAA,CAAA,WAAQ,AAAD,EAAE,QAAQ,OAAO,MAAM,CAAC,MAAM,CAAC,MAAM,EAAE,YAAU;QACxD,UAAU;YAAE,GAAG,MAAM;QAAC;IAC1B;AACJ;AAEO,MAAM,SAAS,CAAC,QAAgB;IACnC,sCAAsC;IACtC,QAAQ,GAAG,CAAC;AAChB;AAEO,MAAM,WAAW,CAAC,QAAgB;IACrC,sCAAsC;IACtC,QAAQ,GAAG,CAAC;AAChB","debugId":null}},
    {"offset": {"line": 332, "column": 0}, "map": {"version":3,"sources":["file:///Users/silsmaria/Projects/mathview/components/mathview/Logic/handleInput.ts"],"sourcesContent":["import { Cursor } from '../Types'\nimport { logNodeTree } from './nodeUtils'\nimport { insertExponent, insertFraction, insertSymbol } from './edit'\nimport { moveLeft, moveRight, moveUp, moveDown } from './navigation'\n\nexport const handleInput = (input: string, cursor: Cursor, setCursor: (cursor: Cursor) => void) => {\n    logNodeTree(cursor.root)\n\n    // Handle arrow keys\n    if (input === 'ArrowLeft') {\n        moveLeft(cursor, setCursor)\n        return\n    }\n    if (input === 'ArrowRight') {\n        moveRight(cursor, setCursor)\n        return\n    }\n    if (input === 'ArrowUp') {\n        moveUp(cursor, setCursor)\n        return\n    }\n    if (input === 'ArrowDown') {\n        moveDown(cursor, setCursor)\n        return\n    }\n\n    // Handle other inputs\n    if (['+', '-', '*'].includes(input) || /^[0-9]$/.test(input)) {\n        insertSymbol(input, cursor)\n        // Force a re-render by creating a new cursor object\n        setCursor({ ...cursor })\n    } else if (input === '/') {\n        insertFraction(cursor)\n        setCursor({ ...cursor })\n    } else if (input === '^') {\n        insertExponent(input, cursor)\n        setCursor({ ...cursor })\n    }\n}\n"],"names":[],"mappings":";;;AACA;AACA;AACA;;;;AAEO,MAAM,cAAc,CAAC,OAAe,QAAgB;IACvD,CAAA,GAAA,4IAAA,CAAA,cAAW,AAAD,EAAE,OAAO,IAAI;IAEvB,oBAAoB;IACpB,IAAI,UAAU,aAAa;QACvB,CAAA,GAAA,6IAAA,CAAA,WAAQ,AAAD,EAAE,QAAQ;QACjB;IACJ;IACA,IAAI,UAAU,cAAc;QACxB,CAAA,GAAA,6IAAA,CAAA,YAAS,AAAD,EAAE,QAAQ;QAClB;IACJ;IACA,IAAI,UAAU,WAAW;QACrB,CAAA,GAAA,6IAAA,CAAA,SAAM,AAAD,EAAE,QAAQ;QACf;IACJ;IACA,IAAI,UAAU,aAAa;QACvB,CAAA,GAAA,6IAAA,CAAA,WAAQ,AAAD,EAAE,QAAQ;QACjB;IACJ;IAEA,sBAAsB;IACtB,IAAI;QAAC;QAAK;QAAK;KAAI,CAAC,QAAQ,CAAC,UAAU,UAAU,IAAI,CAAC,QAAQ;QAC1D,CAAA,GAAA,uIAAA,CAAA,eAAY,AAAD,EAAE,OAAO;QACpB,oDAAoD;QACpD,UAAU;YAAE,GAAG,MAAM;QAAC;IAC1B,OAAO,IAAI,UAAU,KAAK;QACtB,CAAA,GAAA,uIAAA,CAAA,iBAAc,AAAD,EAAE;QACf,UAAU;YAAE,GAAG,MAAM;QAAC;IAC1B,OAAO,IAAI,UAAU,KAAK;QACtB,CAAA,GAAA,uIAAA,CAAA,iBAAc,AAAD,EAAE,OAAO;QACtB,UAAU;YAAE,GAAG,MAAM;QAAC;IAC1B;AACJ","debugId":null}},
    {"offset": {"line": 389, "column": 0}, "map": {"version":3,"sources":["file:///Users/silsmaria/Projects/mathview/components/mathview/MathInput.tsx"],"sourcesContent":["import React, { forwardRef } from 'react'\nimport { Cursor } from './Types'\nimport { handleInput } from './Logic/handleInput'\n\ninterface MathInputProps {\n    cursor: Cursor\n    setCursor: (cursor: Cursor) => void\n    onFocus?: () => void\n    onBlur?: () => void\n}\n\nconst MathInput = forwardRef<HTMLDivElement, MathInputProps>(({ cursor, setCursor, onFocus, onBlur }, ref) => {\n    const handleKeyDown = (e: React.KeyboardEvent<HTMLDivElement>) => {\n        if (e.key.startsWith('Arrow')) {\n            e.preventDefault()\n            e.stopPropagation()\n            console.log('key', e.key)\n            handleInput(e.key, cursor, setCursor)\n        } else if (e.key.length === 1) {\n            console.log('key', e.key)\n            handleInput(e.key, cursor, setCursor)\n        }\n    }\n\n    return (\n        <div\n            ref={ref}\n            className=\"w-full h-full outline-none\"\n            tabIndex={0}\n            role=\"textbox\"\n            aria-label=\"Math input\"\n            onKeyDown={handleKeyDown}\n            onFocus={onFocus}\n            onBlur={onBlur}\n        />\n    )\n})\n\nMathInput.displayName = 'MathInput'\n\nexport default MathInput\n"],"names":[],"mappings":";;;;AAAA;AAEA;;;;AASA,MAAM,0BAAY,CAAA,GAAA,yVAAA,CAAA,aAAU,AAAD,EAAkC,CAAC,EAAE,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,MAAM,EAAE,EAAE;IAClG,MAAM,gBAAgB,CAAC;QACnB,IAAI,EAAE,GAAG,CAAC,UAAU,CAAC,UAAU;YAC3B,EAAE,cAAc;YAChB,EAAE,eAAe;YACjB,QAAQ,GAAG,CAAC,OAAO,EAAE,GAAG;YACxB,CAAA,GAAA,8IAAA,CAAA,cAAW,AAAD,EAAE,EAAE,GAAG,EAAE,QAAQ;QAC/B,OAAO,IAAI,EAAE,GAAG,CAAC,MAAM,KAAK,GAAG;YAC3B,QAAQ,GAAG,CAAC,OAAO,EAAE,GAAG;YACxB,CAAA,GAAA,8IAAA,CAAA,cAAW,AAAD,EAAE,EAAE,GAAG,EAAE,QAAQ;QAC/B;IACJ;IAEA,qBACI,kYAAC;QACG,KAAK;QACL,WAAU;QACV,UAAU;QACV,MAAK;QACL,cAAW;QACX,WAAW;QACX,SAAS;QACT,QAAQ;;;;;;AAGpB;AAEA,UAAU,WAAW,GAAG;uCAET","debugId":null}},
    {"offset": {"line": 432, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/components/mathview/Render/MathRender.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"absoluteCursor\": \"MathRender-module__1683Gq__absoluteCursor\",\n  \"anchor\": \"MathRender-module__1683Gq__anchor\",\n  \"binaryOperator\": \"MathRender-module__1683Gq__binaryOperator\",\n  \"blink\": \"MathRender-module__1683Gq__blink\",\n  \"content\": \"MathRender-module__1683Gq__content\",\n  \"cursor\": \"MathRender-module__1683Gq__cursor\",\n  \"denominator\": \"MathRender-module__1683Gq__denominator\",\n  \"empty\": \"MathRender-module__1683Gq__empty\",\n  \"exponent\": \"MathRender-module__1683Gq__exponent\",\n  \"exponentContent\": \"MathRender-module__1683Gq__exponentContent\",\n  \"fraction\": \"MathRender-module__1683Gq__fraction\",\n  \"nonLeaf\": \"MathRender-module__1683Gq__nonLeaf\",\n  \"numerator\": \"MathRender-module__1683Gq__numerator\",\n  \"rootBlock\": \"MathRender-module__1683Gq__rootBlock\",\n  \"symbol\": \"MathRender-module__1683Gq__symbol\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 455, "column": 0}, "map": {"version":3,"sources":["file:///Users/silsmaria/Projects/mathview/components/mathview/Render/MathRender.tsx"],"sourcesContent":["import React, { useEffect, useMemo, useRef, useState } from 'react'\nimport { Cursor, Node, Symbol as SymbolNodeType, Row, Fraction, Exponent, MathViewConfig } from '../Types'\nimport styles from './MathRender.module.css'\n\ninterface MathRenderProps {\n  cursor: Cursor | null\n  config?: MathViewConfig\n  showCursor?: boolean\n  nodeKey?: string\n}\n\nconst ZWSP = '\\u200B'\n\nfunction isBinaryOperatorChar(char: string): boolean {\n  if (char.length !== 1) return false\n  const isDigit = /[0-9]/.test(char)\n  const isOperator = /[+\\-*/=<>]/.test(char)\n  return isOperator && !isDigit\n}\n\nfunction SymbolNode({ node, color }: { node: SymbolNodeType; color?: string }) {\n  const displayValue = node.value === '*' ? '·' : node.value === '-' ? '−' : node.value\n  const binary = isBinaryOperatorChar(node.value)\n  const className = [styles.symbol, binary ? styles.binaryOperator : ''].filter(Boolean).join(' ')\n  return (\n    <span key={node.id} className={className} data-symbol={node.value} style={{ color }}>\n      {displayValue}\n    </span>\n  )\n}\n\nfunction RowNode({ node, renderChild }: { node: Row; renderChild: (n: Node) => React.ReactNode }) {\n  return <span key={node.id} className={styles.row}>{node.children.map(renderChild)}</span>\n}\n\nfunction FractionNode({ node, renderChild }: { node: Fraction; renderChild: (n: Node) => React.ReactNode }) {\n  const className = [styles.fraction, styles.nonLeaf].join(' ')\n  const numeratorEmpty = !node.numerator.children || node.numerator.children.length === 0\n  const denominatorEmpty = !node.denominator.children || node.denominator.children.length === 0\n  return (\n    <span key={node.id} className={className}>\n      <span className={styles.numerator}>\n        {renderChild(node.numerator)}\n        {numeratorEmpty ? ZWSP : ''}\n      </span>\n      <span className={styles.denominator}>\n        {renderChild(node.denominator)}\n        {denominatorEmpty ? ZWSP : ''}\n      </span>\n      <span style={{ display: 'inline-block', width: 0 }}>{ZWSP}</span>\n    </span>\n  )\n}\n\nfunction ExponentNode({ node, renderChild }: { node: Exponent; renderChild: (n: Node) => React.ReactNode }) {\n  const className = [styles.exponent, styles.nonLeaf].join(' ')\n  const raisedEmpty = !node.raised.children || node.raised.children.length === 0\n  return (\n    <span key={node.id} className={className}>\n      {renderChild(node.base)}\n      <span className={styles.exponentContent}>\n        {renderChild(node.raised)}\n        {raisedEmpty ? ZWSP : ''}\n      </span>\n    </span>\n  )\n}\n\nfunction Caret({ node, color, blinkHidden }: { node: Cursor; color?: string; blinkHidden: boolean }) {\n  const isFirst = !!node.parent && node.parent.children.length > 0 && node.parent.children[0] === node\n  const className = [styles.cursor, blinkHidden ? styles.blink : ''].filter(Boolean).join(' ')\n\n  if (isFirst) {\n    return (\n      <>\n        <span\n          aria-hidden=\"true\"\n          style={{ display: 'inline-block', width: 0, paddingLeft: '1px', marginLeft: '-1px', height: 0 }}\n        />\n        <span className={className} style={{ borderLeftColor: color }}>{ZWSP}</span>\n      </>\n    )\n  }\n\n  return <span className={className} style={{ borderLeftColor: color }}>{ZWSP}</span>\n}\n\nexport default function MathRender({ cursor, config, showCursor = true, nodeKey }: MathRenderProps) {\n  const [blinkHidden, setBlinkHidden] = useState(false)\n  const anchorRef = useRef<HTMLSpanElement | null>(null)\n  const contentRef = useRef<HTMLSpanElement | null>(null)\n  const [reservedWidthPx, setReservedWidthPx] = useState<number>(0)\n\n  const mergedConfig: Required<MathViewConfig> = {\n    fontFamily: 'Times New Roman, serif',\n    fontSize: '16px',\n    fontColor: '#000000',\n    backgroundColor: 'transparent',\n    cursorColor: '#000000',\n    ...config,\n  }\n\n  useEffect(() => {\n    const intervalId = setInterval(() => setBlinkHidden((prev) => !prev), 500)\n    return () => clearInterval(intervalId)\n  }, [])\n\n  const rootNode: Node | null = cursor ? cursor.root : null\n  const isEmptyRoot = useMemo(() => {\n    if (!rootNode || rootNode.type !== 'row') return true\n    return rootNode.children.filter((c) => c.type !== 'cursor').length === 0\n  }, [rootNode])\n\n  const rootClassName = [styles.rootBlock, isEmptyRoot ? styles.empty : ''].filter(Boolean).join(' ')\n\n  const renderChild = (child: Node): React.ReactNode => {\n    switch (child.type) {\n      case 'symbol':\n        return <SymbolNode key={child.id} node={child as SymbolNodeType} color={mergedConfig.fontColor} />\n      case 'row':\n        return <RowNode key={child.id} node={child as Row} renderChild={renderChild} />\n      case 'fraction':\n        return <FractionNode key={child.id} node={child as Fraction} renderChild={renderChild} />\n      case 'exponent':\n        return <ExponentNode key={child.id} node={child as Exponent} renderChild={renderChild} />\n      case 'cursor':\n        if (!showCursor) return null\n        return <Caret key={(child as Cursor).id} node={child as Cursor} color={mergedConfig.cursorColor} blinkHidden={blinkHidden} />\n      default:\n        return null\n    }\n  }\n\n  // Measure content size and reserve width while pushing only the following line(s) down\n  useEffect(() => {\n    const anchorEl = anchorRef.current\n    const contentEl = contentRef.current\n    if (!anchorEl || !contentEl) return\n\n    const recompute = () => {\n      const rect = contentEl.getBoundingClientRect()\n      const width = Math.ceil(rect.width)\n      const height = Math.ceil(rect.height)\n      setReservedWidthPx(width)\n\n      const paragraph = anchorEl.closest('p') as HTMLElement | null\n      let extra = height\n      let lineHeightPx = 0\n      if (paragraph) {\n        const cs = window.getComputedStyle(paragraph)\n        if (cs.lineHeight === 'normal') {\n          const fontSizePx = parseFloat(cs.fontSize || '15')\n          lineHeightPx = Math.round(fontSizePx * 1.2)\n        } else {\n          lineHeightPx = parseFloat(cs.lineHeight)\n        }\n        if (!Number.isNaN(lineHeightPx) && lineHeightPx > 0) {\n          extra = Math.max(0, height - lineHeightPx)\n        }\n      }\n\n      anchorEl.dataset.mathExtra = String(extra)\n\n      if (paragraph) {\n        const anchors = paragraph.querySelectorAll('[data-math-extra]')\n        let maxExtra = 0\n        anchors.forEach((a) => {\n          const v = Number((a as HTMLElement).dataset.mathExtra || '0')\n          if (!Number.isNaN(v)) maxExtra = Math.max(maxExtra, v)\n        })\n        paragraph.style.paddingBottom = maxExtra > 0 ? `${Math.ceil(maxExtra)}px` : ''\n      }\n\n      // Shift rendered math up by one line height to correct the visual baseline offset\n      if (lineHeightPx > 0) {\n        contentEl.style.top = `-${Math.ceil(lineHeightPx)}px`\n      } else {\n        contentEl.style.top = '0px'\n      }\n\n      // Notify Lexical layer about overflow so it can split and insert spacer\n      if (nodeKey) {\n        document.dispatchEvent(new CustomEvent('math-overflow', { detail: { nodeKey, extraPx: extra } }))\n      }\n    }\n\n    const ro = new ResizeObserver(() => recompute())\n    ro.observe(contentEl)\n    recompute()\n\n    return () => {\n      ro.disconnect()\n      delete anchorEl.dataset.mathExtra\n      const paragraph = anchorEl.closest('p') as HTMLElement | null\n      if (paragraph) {\n        const anchors = paragraph.querySelectorAll('[data-math-extra]')\n        let maxExtra = 0\n        anchors.forEach((a) => {\n          const v = Number((a as HTMLElement).dataset.mathExtra || '0')\n          if (!Number.isNaN(v)) maxExtra = Math.max(maxExtra, v)\n        })\n        paragraph.style.paddingBottom = maxExtra > 0 ? `${Math.ceil(maxExtra)}px` : ''\n      }\n    }\n  }, [mergedConfig.fontFamily, mergedConfig.fontSize, rootNode])\n\n  return (\n    <span\n      ref={anchorRef}\n      className={styles.anchor}\n      aria-hidden=\"true\"\n      style={{ width: reservedWidthPx ? `${reservedWidthPx}px` : undefined }}\n    >\n      <span ref={contentRef} className={styles.content}>\n        <span className={rootClassName}>\n          {rootNode ? renderChild(rootNode) : ZWSP}\n          {isEmptyRoot ? ZWSP : ''}\n        </span>\n      </span>\n    </span>\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 819, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/components/mathview/MathEditor.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"container\": \"MathEditor-module___d-iqW__container\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA"}},
    {"offset": {"line": 828, "column": 0}, "map": {"version":3,"sources":["file:///Users/silsmaria/Projects/mathview/components/mathview/MathEditor.tsx"],"sourcesContent":["\"use client\"\nimport React, { useEffect, useRef, useState, forwardRef, useImperativeHandle } from 'react'\nimport MathInput from './MathInput'\nimport MathRender from '@/components/mathview/Render/MathRender'\nimport { Row, Cursor, MathViewConfig } from './Types'\nimport { handleInput } from './Logic/handleInput'\nimport { moveNode } from './Logic/helperFunctons'\nimport styles from './MathEditor.module.css'\n\nlet id = 0;\nexport const createId = () => {\n    id++;\n    return id.toString();\n}\n\ninterface MathEditorProps {\n    config?: MathViewConfig;\n    nodeKey?: string;\n}\n\n// Interface for the MathEditor API\nexport interface MathEditorAPI {\n    insert: (input: string) => void;\n    focus: () => void;\n    setCursorToStart: () => void;\n    setCursorToEnd: () => void;\n}\n\nconst MathEditor = forwardRef<MathEditorAPI, MathEditorProps>(({ config = {}, nodeKey }, ref) => {\n    const rootRef = useRef<Row | null>(null)\n    const [cursor, setCursor] = useState<Cursor | null>(null)\n    const inputRef = useRef<HTMLDivElement>(null)\n    const [isFocused, setIsFocused] = useState(false)\n\n    console.log('MathEditor rendering, cursor:', cursor);\n\n    // Default configuration\n    const defaultConfig: MathViewConfig = {\n        fontFamily: 'Times New Roman, serif',\n        fontSize: '20px',\n        fontColor: '#000000',\n        backgroundColor: 'transparent',\n        cursorColor: '#000000',\n        ...config\n    }\n\n    // Initialize root and cursor synchronously\n    if (!rootRef.current) {\n        console.log('MathEditor initializing...');\n        const root: Row = {\n            id: \"root\",\n            type: 'row',\n            children: [],\n            parent: null\n        }\n        rootRef.current = root\n\n        const newCursor: Cursor = {\n            id: \"cursor\",\n            type: 'cursor',\n            parent: root,\n            root: root\n        }\n        setCursor(newCursor)\n        root.children = [newCursor]\n        console.log('MathEditor initialized with cursor:', newCursor);\n    }\n\n    // Expose API methods via useImperativeHandle\n    useImperativeHandle(ref, () => ({\n        insert: (symbol: string) => {\n            if (cursor) {\n                handleInput(symbol, cursor, setCursor)\n            }\n        },\n        focus: () => {\n            inputRef.current?.focus();\n        },\n        setCursorToStart: () => {\n            if (cursor && rootRef.current) {\n                // Move cursor to the beginning of the root (index 0)\n                moveNode(cursor, rootRef.current, 0);\n                setCursor({ ...cursor });\n                inputRef.current?.focus();\n            }\n        },\n        setCursorToEnd: () => {\n            if (cursor && rootRef.current) {\n                // Move cursor to the end of the root (after all children)\n                moveNode(cursor, rootRef.current, rootRef.current.children.length);\n                setCursor({ ...cursor });\n                inputRef.current?.focus();\n            }\n        }\n    }), [cursor])\n\n    const handleContainerMouseDown = (e: React.MouseEvent) => {\n        e.preventDefault()\n        inputRef.current?.focus()\n    }\n\n    const handleFocus = () => {\n        setIsFocused(true)\n        if (nodeKey) {\n            (window as any).currentMathNodeKey = nodeKey;\n        }\n    }\n\n    const handleBlur = () => {\n        setIsFocused(false)\n    }\n\n    const containerStyle: React.CSSProperties = {\n        fontFamily: defaultConfig.fontFamily,\n        fontSize: defaultConfig.fontSize,\n        color: defaultConfig.fontColor,\n        backgroundColor: defaultConfig.backgroundColor,\n    }\n\n    return (\n        <div className={styles.wrapper} style={containerStyle}>\n            <div\n                className={styles.container}\n                onMouseDown={handleContainerMouseDown}\n            >\n                <MathRender cursor={cursor} config={defaultConfig} showCursor={isFocused} nodeKey={nodeKey} />\n                <MathInput \n                    cursor={cursor} \n                    setCursor={setCursor} \n                    ref={inputRef}\n                    onFocus={handleFocus}\n                    onBlur={handleBlur}\n                />\n            </div>\n        </div>\n    )\n})\n\nMathEditor.displayName = 'MathEditor'\n\nexport default MathEditor"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 989, "column": 0}, "map": {"version":3,"sources":["file:///Users/silsmaria/Projects/mathview/components/Editor/plugins/UndoRedo.tsx"],"sourcesContent":["import { useLexicalComposerContext } from \"@lexical/react/LexicalComposerContext\";\nimport { UNDO_COMMAND, REDO_COMMAND } from \"lexical\";\nimport \"../styles.css\";\n\nexport default function UndoRedo() {\n  const [editor] = useLexicalComposerContext();\n\n  const onUndo = () => {\n    editor.dispatchCommand(UNDO_COMMAND, undefined);\n  };\n\n  const onRedo = () => {\n    editor.dispatchCommand(REDO_COMMAND, undefined);\n  };\n\n  return (\n    <>\n      <button className=\"button\" onClick={onUndo}>\n        ←\n      </button>\n      <button className=\"button\" onClick={onRedo}>\n        →\n      </button>\n    </>\n  );\n} "],"names":[],"mappings":";;;;AAAA;AACA;;;;;AAGe,SAAS;IACtB,MAAM,CAAC,OAAO,GAAG,CAAA,GAAA,sUAAA,CAAA,4BAAyB,AAAD;IAEzC,MAAM,SAAS;QACb,OAAO,eAAe,CAAC,+LAAA,CAAA,eAAY,EAAE;IACvC;IAEA,MAAM,SAAS;QACb,OAAO,eAAe,CAAC,+LAAA,CAAA,eAAY,EAAE;IACvC;IAEA,qBACE;;0BACE,kYAAC;gBAAO,WAAU;gBAAS,SAAS;0BAAQ;;;;;;0BAG5C,kYAAC;gBAAO,WAAU;gBAAS,SAAS;0BAAQ;;;;;;;;AAKlD","debugId":null}},
    {"offset": {"line": 1036, "column": 0}, "map": {"version":3,"sources":["file:///Users/silsmaria/Projects/mathview/components/Editor/plugins/BlockType.tsx"],"sourcesContent":["import { useLexicalComposerContext } from \"@lexical/react/LexicalComposerContext\";\nimport { $getSelection, $isRangeSelection } from \"lexical\";\nimport { $createHeadingNode } from \"@lexical/rich-text\";\nimport { $setBlocksType } from \"@lexical/selection\";\nimport { useState, useRef, useEffect } from \"react\";\nimport \"../styles.css\";\n\nexport default function TextFormat() {\n  const [editor] = useLexicalComposerContext();\n  const [isDropdownOpen, setIsDropdownOpen] = useState(false);\n  const [selectedFormat, setSelectedFormat] = useState('Normal Text');\n  const dropdownRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setIsDropdownOpen(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, []);\n\n  const onHeadingClick = (tag: 'h1' | 'h2' | 'h3'): void => {\n    editor.update(() => {\n      const selection = $getSelection();\n      if ($isRangeSelection(selection)) {\n        $setBlocksType(selection, () => $createHeadingNode(tag));\n      }\n    });\n  };\n\n  const onNormalTextClick = () => {\n    editor.update(() => {\n      const selection = $getSelection();\n      if ($isRangeSelection(selection)) {\n        $setBlocksType(selection, () => null);\n      }\n    });\n  };\n\n  return (\n    <div style={{ position: 'relative' }} ref={dropdownRef}>\n      <button\n        onClick={() => setIsDropdownOpen(!isDropdownOpen)}\n        className=\"dropdown\"\n      >\n        {selectedFormat}\n        <span style={{ fontSize: '12px' }}>▼</span>\n      </button>\n      {isDropdownOpen && (\n        <div\n          style={{\n            position: 'absolute',\n            top: '100%',\n            left: '0',\n            background: 'white',\n            border: '1px solid #ccc',\n            borderRadius: '4px',\n            marginTop: '4px',\n            boxShadow: '0 2px 4px rgba(0,0,0,0.1)',\n            zIndex: 1000,\n            minWidth: '120px'\n          }}\n        >\n          <button\n            style={{\n              padding: '8px',\n              width: '100%',\n              textAlign: 'left',\n              border: 'none',\n              background: 'none',\n              cursor: 'pointer',\n              color: 'black',\n              borderBottom: '1px solid #eee'\n            }}\n            onClick={() => {\n              onNormalTextClick();\n              setSelectedFormat('Normal Text');\n              setIsDropdownOpen(false);\n            }}\n          >\n            Normal Text\n          </button>\n          {['Header 1', 'Header 2', 'Header 3'].map((text, index) => (\n            <button\n              key={text}\n              style={{\n                padding: '8px',\n                width: '100%',\n                textAlign: 'left',\n                border: 'none',\n                background: 'none',\n                cursor: 'pointer',\n                color: 'black',\n                borderBottom: index < 2 ? '1px solid #eee' : 'none'\n              }}\n              onClick={() => {\n                onHeadingClick(`h${index + 1}` as 'h1' | 'h2' | 'h3');\n                setSelectedFormat(text);\n                setIsDropdownOpen(false);\n              }}\n            >\n              {text}\n            </button>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n} "],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;;;;;;;;AAGe,SAAS;IACtB,MAAM,CAAC,OAAO,GAAG,CAAA,GAAA,sUAAA,CAAA,4BAAyB,AAAD;IACzC,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,CAAA,GAAA,yVAAA,CAAA,WAAQ,AAAD,EAAE;IACrD,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,CAAA,GAAA,yVAAA,CAAA,WAAQ,AAAD,EAAE;IACrD,MAAM,cAAc,CAAA,GAAA,yVAAA,CAAA,SAAM,AAAD,EAAkB;IAE3C,CAAA,GAAA,yVAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,qBAAqB,CAAC;YAC1B,IAAI,YAAY,OAAO,IAAI,CAAC,YAAY,OAAO,CAAC,QAAQ,CAAC,MAAM,MAAM,GAAW;gBAC9E,kBAAkB;YACpB;QACF;QAEA,SAAS,gBAAgB,CAAC,aAAa;QACvC,OAAO;YACL,SAAS,mBAAmB,CAAC,aAAa;QAC5C;IACF,GAAG,EAAE;IAEL,MAAM,iBAAiB,CAAC;QACtB,OAAO,MAAM,CAAC;YACZ,MAAM,YAAY,CAAA,GAAA,+LAAA,CAAA,gBAAa,AAAD;YAC9B,IAAI,CAAA,GAAA,+LAAA,CAAA,oBAAiB,AAAD,EAAE,YAAY;gBAChC,CAAA,GAAA,sPAAA,CAAA,iBAAc,AAAD,EAAE,WAAW,IAAM,CAAA,GAAA,2OAAA,CAAA,qBAAkB,AAAD,EAAE;YACrD;QACF;IACF;IAEA,MAAM,oBAAoB;QACxB,OAAO,MAAM,CAAC;YACZ,MAAM,YAAY,CAAA,GAAA,+LAAA,CAAA,gBAAa,AAAD;YAC9B,IAAI,CAAA,GAAA,+LAAA,CAAA,oBAAiB,AAAD,EAAE,YAAY;gBAChC,CAAA,GAAA,sPAAA,CAAA,iBAAc,AAAD,EAAE,WAAW,IAAM;YAClC;QACF;IACF;IAEA,qBACE,kYAAC;QAAI,OAAO;YAAE,UAAU;QAAW;QAAG,KAAK;;0BACzC,kYAAC;gBACC,SAAS,IAAM,kBAAkB,CAAC;gBAClC,WAAU;;oBAET;kCACD,kYAAC;wBAAK,OAAO;4BAAE,UAAU;wBAAO;kCAAG;;;;;;;;;;;;YAEpC,gCACC,kYAAC;gBACC,OAAO;oBACL,UAAU;oBACV,KAAK;oBACL,MAAM;oBACN,YAAY;oBACZ,QAAQ;oBACR,cAAc;oBACd,WAAW;oBACX,WAAW;oBACX,QAAQ;oBACR,UAAU;gBACZ;;kCAEA,kYAAC;wBACC,OAAO;4BACL,SAAS;4BACT,OAAO;4BACP,WAAW;4BACX,QAAQ;4BACR,YAAY;4BACZ,QAAQ;4BACR,OAAO;4BACP,cAAc;wBAChB;wBACA,SAAS;4BACP;4BACA,kBAAkB;4BAClB,kBAAkB;wBACpB;kCACD;;;;;;oBAGA;wBAAC;wBAAY;wBAAY;qBAAW,CAAC,GAAG,CAAC,CAAC,MAAM,sBAC/C,kYAAC;4BAEC,OAAO;gCACL,SAAS;gCACT,OAAO;gCACP,WAAW;gCACX,QAAQ;gCACR,YAAY;gCACZ,QAAQ;gCACR,OAAO;gCACP,cAAc,QAAQ,IAAI,mBAAmB;4BAC/C;4BACA,SAAS;gCACP,eAAe,CAAC,CAAC,EAAE,QAAQ,GAAG;gCAC9B,kBAAkB;gCAClB,kBAAkB;4BACpB;sCAEC;2BAjBI;;;;;;;;;;;;;;;;;AAwBnB","debugId":null}},
    {"offset": {"line": 1192, "column": 0}, "map": {"version":3,"sources":["file:///Users/silsmaria/Projects/mathview/components/Editor/plugins/Font.tsx"],"sourcesContent":["import { useLexicalComposerContext } from \"@lexical/react/LexicalComposerContext\";\nimport { $getSelection, $isRangeSelection } from \"lexical\";\nimport { $patchStyleText } from \"@lexical/selection\";\nimport { useState, useRef, useEffect } from \"react\";\nimport \"../styles.css\";\n\nexport default function Font() {\n    const [editor] = useLexicalComposerContext();\n    const [isFontDropdownOpen, setIsFontDropdownOpen] = useState(false);\n    const [selectedFont, setSelectedFont] = useState('Arial');\n    const dropdownRef = useRef<HTMLDivElement>(null);\n\n    useEffect(() => {\n        const handleClickOutside = (event: MouseEvent) => {\n          if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n            setIsFontDropdownOpen(false);\n          }\n        };\n    \n        document.addEventListener('mousedown', handleClickOutside);\n        return () => {\n          document.removeEventListener('mousedown', handleClickOutside);\n        };\n      }, []);\n\n    const onFont = (font: string) => { \n        editor.update(() => {\n          const selection = $getSelection();\n          if ($isRangeSelection(selection)) {\n            $patchStyleText(selection, { 'font-family': font });\n          }\n        });\n      };\n\n    return (\n        <div style={{ position: 'relative' }} ref={dropdownRef}>\n        <button\n          onClick={() => setIsFontDropdownOpen(!isFontDropdownOpen)}\n          className=\"dropdown\"\n        >\n          {selectedFont}\n          <span style={{ fontSize: '12px' }}>▼</span>\n        </button>\n        {isFontDropdownOpen && (\n          <div\n            style={{\n              position: 'absolute',\n              top: '100%',\n              left: '0',\n              background: 'white',\n              border: '1px solid #ccc',\n              borderRadius: '4px',\n              marginTop: '4px',\n              boxShadow: '0 2px 4px rgba(0,0,0,0.1)',\n              zIndex: 1000,\n              minWidth: '120px'\n            }}\n          >\n            {[\n              { text: 'Arial', action: () => { onFont('Arial'); setSelectedFont('Arial'); } },\n              { text: 'Verdana', action: () => { onFont('Verdana'); setSelectedFont('Verdana'); } },\n              { text: 'Times New Roman', action: () => { onFont('Times New Roman'); setSelectedFont('Times New Roman'); } },\n              { text: 'Courier New', action: () => { onFont('Courier New'); setSelectedFont('Courier New'); } },\n            ].map((item, index) => (\n              <button\n                key={item.text}\n                style={{\n                  padding: '8px',\n                  width: '100%',\n                  textAlign: 'left',\n                  border: 'none',\n                  background: 'none',\n                  cursor: 'pointer',\n                  color: 'black',\n                  borderBottom: index < 3 ? '1px solid #eee' : 'none'\n                }}\n                onClick={() => {\n                  item.action();\n                  setIsFontDropdownOpen(false);\n                }}\n              >\n                {item.text}\n              </button>\n            ))}\n          </div>\n        )}\n      </div>\n    );\n} "],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;;;AAGe,SAAS;IACpB,MAAM,CAAC,OAAO,GAAG,CAAA,GAAA,sUAAA,CAAA,4BAAyB,AAAD;IACzC,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,CAAA,GAAA,yVAAA,CAAA,WAAQ,AAAD,EAAE;IAC7D,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,yVAAA,CAAA,WAAQ,AAAD,EAAE;IACjD,MAAM,cAAc,CAAA,GAAA,yVAAA,CAAA,SAAM,AAAD,EAAkB;IAE3C,CAAA,GAAA,yVAAA,CAAA,YAAS,AAAD,EAAE;QACN,MAAM,qBAAqB,CAAC;YAC1B,IAAI,YAAY,OAAO,IAAI,CAAC,YAAY,OAAO,CAAC,QAAQ,CAAC,MAAM,MAAM,GAAW;gBAC9E,sBAAsB;YACxB;QACF;QAEA,SAAS,gBAAgB,CAAC,aAAa;QACvC,OAAO;YACL,SAAS,mBAAmB,CAAC,aAAa;QAC5C;IACF,GAAG,EAAE;IAEP,MAAM,SAAS,CAAC;QACZ,OAAO,MAAM,CAAC;YACZ,MAAM,YAAY,CAAA,GAAA,+LAAA,CAAA,gBAAa,AAAD;YAC9B,IAAI,CAAA,GAAA,+LAAA,CAAA,oBAAiB,AAAD,EAAE,YAAY;gBAChC,CAAA,GAAA,sPAAA,CAAA,kBAAe,AAAD,EAAE,WAAW;oBAAE,eAAe;gBAAK;YACnD;QACF;IACF;IAEF,qBACI,kYAAC;QAAI,OAAO;YAAE,UAAU;QAAW;QAAG,KAAK;;0BAC3C,kYAAC;gBACC,SAAS,IAAM,sBAAsB,CAAC;gBACtC,WAAU;;oBAET;kCACD,kYAAC;wBAAK,OAAO;4BAAE,UAAU;wBAAO;kCAAG;;;;;;;;;;;;YAEpC,oCACC,kYAAC;gBACC,OAAO;oBACL,UAAU;oBACV,KAAK;oBACL,MAAM;oBACN,YAAY;oBACZ,QAAQ;oBACR,cAAc;oBACd,WAAW;oBACX,WAAW;oBACX,QAAQ;oBACR,UAAU;gBACZ;0BAEC;oBACC;wBAAE,MAAM;wBAAS,QAAQ;4BAAQ,OAAO;4BAAU,gBAAgB;wBAAU;oBAAE;oBAC9E;wBAAE,MAAM;wBAAW,QAAQ;4BAAQ,OAAO;4BAAY,gBAAgB;wBAAY;oBAAE;oBACpF;wBAAE,MAAM;wBAAmB,QAAQ;4BAAQ,OAAO;4BAAoB,gBAAgB;wBAAoB;oBAAE;oBAC5G;wBAAE,MAAM;wBAAe,QAAQ;4BAAQ,OAAO;4BAAgB,gBAAgB;wBAAgB;oBAAE;iBACjG,CAAC,GAAG,CAAC,CAAC,MAAM,sBACX,kYAAC;wBAEC,OAAO;4BACL,SAAS;4BACT,OAAO;4BACP,WAAW;4BACX,QAAQ;4BACR,YAAY;4BACZ,QAAQ;4BACR,OAAO;4BACP,cAAc,QAAQ,IAAI,mBAAmB;wBAC/C;wBACA,SAAS;4BACP,KAAK,MAAM;4BACX,sBAAsB;wBACxB;kCAEC,KAAK,IAAI;uBAhBL,KAAK,IAAI;;;;;;;;;;;;;;;;AAuB9B","debugId":null}},
    {"offset": {"line": 1340, "column": 0}, "map": {"version":3,"sources":["file:///Users/silsmaria/Projects/mathview/components/Editor/plugins/FontSize.tsx"],"sourcesContent":["import { useLexicalComposerContext } from \"@lexical/react/LexicalComposerContext\";\nimport { $getSelection, $isRangeSelection } from \"lexical\";\nimport { $patchStyleText } from \"@lexical/selection\";\nimport { useState, useRef, useEffect } from \"react\";\nimport \"../styles.css\";\n\n// Constants\nconst MIN_FONT_SIZE = 4;\nconst MAX_FONT_SIZE = 72;\nconst DEFAULT_FONT_SIZE = 12;\nconst DRAG_SENSITIVITY = 5;\nconst EDGE_WIDTH = 8;\n\nexport default function FontSize() {\n  const [editor] = useLexicalComposerContext();\n  const [fontSize, setFontSize] = useState(DEFAULT_FONT_SIZE);\n  const [inputValue, setInputValue] = useState(DEFAULT_FONT_SIZE.toString());\n  const [isEditing, setIsEditing] = useState(false);\n  const [isDragging, setIsDragging] = useState(false);\n  const [dragStart, setDragStart] = useState({ x: 0, size: 0 });\n  const [cursorPosition, setCursorPosition] = useState(0);\n  const [selectionStart, setSelectionStart] = useState(0);\n  const [selectionEnd, setSelectionEnd] = useState(0);\n  const [scrollOffset, setScrollOffset] = useState(0);\n  \n  const containerRef = useRef<HTMLDivElement>(null);\n  const measureRef = useRef<HTMLSpanElement>(null);\n\n  // Update font size in editor\n  const updateFontSize = (size: number) => {\n    const clampedSize = Math.max(MIN_FONT_SIZE, Math.min(MAX_FONT_SIZE, size));\n    setFontSize(clampedSize);\n    setInputValue(clampedSize.toString());\n    \n    editor.update(() => {\n      const selection = $getSelection();\n      if ($isRangeSelection(selection)) {\n        $patchStyleText(selection, { 'font-size': `${clampedSize}px` });\n      }\n    });\n  };\n\n  // Handle dragging\n  useEffect(() => {\n    if (!isDragging) return;\n\n    const handleMouseMove = (e: MouseEvent) => {\n      const deltaX = e.clientX - dragStart.x;\n      const deltaSize = Math.round(deltaX / DRAG_SENSITIVITY);\n      const newSize = dragStart.size + deltaSize;\n      updateFontSize(newSize);\n    };\n\n    const handleMouseUp = () => {\n      setIsDragging(false);\n    };\n\n    document.addEventListener('mousemove', handleMouseMove);\n    document.addEventListener('mouseup', handleMouseUp);\n    \n    return () => {\n      document.removeEventListener('mousemove', handleMouseMove);\n      document.removeEventListener('mouseup', handleMouseUp);\n    };\n  }, [isDragging, dragStart, editor]);\n\n  // Handle click outside\n  useEffect(() => {\n    const handleClickOutside = (e: MouseEvent) => {\n      if (containerRef.current && !containerRef.current.contains(e.target as Node)) {\n        setIsEditing(false);\n        setSelectionStart(0);\n        setSelectionEnd(0);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  // Get text width using measurement span\n  const getTextWidth = (text: string) => {\n    if (!measureRef.current) return 0;\n    measureRef.current.textContent = text;\n    return measureRef.current.offsetWidth;\n  };\n\n  // Get cursor position from click\n  const getCursorFromClick = (clickX: number) => {\n    let bestPosition = 0;\n    let minDistance = Infinity;\n    \n    for (let i = 0; i <= inputValue.length; i++) {\n      const textWidth = getTextWidth(inputValue.slice(0, i));\n      const distance = Math.abs(clickX - textWidth);\n      if (distance < minDistance) {\n        minDistance = distance;\n        bestPosition = i;\n      }\n    }\n    return bestPosition;\n  };\n\n  // Handle scrolling to keep cursor visible\n  const updateScroll = () => {\n    const containerWidth = 40 - 16; // 40px width - 16px padding\n    const cursorX = getTextWidth(inputValue.slice(0, cursorPosition));\n    const visibleStart = scrollOffset;\n    const visibleEnd = scrollOffset + containerWidth;\n\n    if (cursorX < visibleStart) {\n      setScrollOffset(Math.max(0, cursorX - 5));\n    } else if (cursorX > visibleEnd) {\n      setScrollOffset(cursorX - containerWidth + 5);\n    }\n  };\n\n  // Update scroll when cursor moves\n  useEffect(() => {\n    if (isEditing) {\n      updateScroll();\n    }\n  }, [cursorPosition, inputValue, isEditing]);\n\n  // Handle keyboard input\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (!isEditing) return;\n    \n    e.stopPropagation();\n    e.preventDefault();\n\n    const hasSelection = selectionStart !== selectionEnd;\n\n    switch (e.key) {\n      case 'Enter':\n        const newSize = parseInt(inputValue) || DEFAULT_FONT_SIZE;\n        updateFontSize(newSize);\n        setIsEditing(false);\n        setSelectionStart(0);\n        setSelectionEnd(0);\n        containerRef.current?.blur();\n        break;\n        \n      case 'Escape':\n        setInputValue(fontSize.toString());\n        setIsEditing(false);\n        setSelectionStart(0);\n        setSelectionEnd(0);\n        setCursorPosition(0);\n        setScrollOffset(0);\n        containerRef.current?.blur();\n        break;\n        \n      case 'Backspace':\n        if (hasSelection) {\n          const start = Math.min(selectionStart, selectionEnd);\n          const end = Math.max(selectionStart, selectionEnd);\n          const newValue = inputValue.slice(0, start) + inputValue.slice(end);\n          setInputValue(newValue);\n          setCursorPosition(start);\n          setSelectionStart(start);\n          setSelectionEnd(start);\n        } else if (cursorPosition > 0) {\n          const newValue = inputValue.slice(0, cursorPosition - 1) + inputValue.slice(cursorPosition);\n          setInputValue(newValue);\n          setCursorPosition(cursorPosition - 1);\n        }\n        break;\n        \n      case 'Delete':\n        if (hasSelection) {\n          const start = Math.min(selectionStart, selectionEnd);\n          const end = Math.max(selectionStart, selectionEnd);\n          const newValue = inputValue.slice(0, start) + inputValue.slice(end);\n          setInputValue(newValue);\n          setCursorPosition(start);\n          setSelectionStart(start);\n          setSelectionEnd(start);\n        } else if (cursorPosition < inputValue.length) {\n          const newValue = inputValue.slice(0, cursorPosition) + inputValue.slice(cursorPosition + 1);\n          setInputValue(newValue);\n        }\n        break;\n        \n      case 'ArrowLeft':\n        if (e.shiftKey) {\n          const newPos = Math.max(0, cursorPosition - 1);\n          setCursorPosition(newPos);\n          setSelectionEnd(newPos);\n        } else {\n          const newPos = hasSelection ? Math.min(selectionStart, selectionEnd) : Math.max(0, cursorPosition - 1);\n          setCursorPosition(newPos);\n          setSelectionStart(newPos);\n          setSelectionEnd(newPos);\n        }\n        break;\n        \n      case 'ArrowRight':\n        if (e.shiftKey) {\n          const newPos = Math.min(inputValue.length, cursorPosition + 1);\n          setCursorPosition(newPos);\n          setSelectionEnd(newPos);\n        } else {\n          const newPos = hasSelection ? Math.max(selectionStart, selectionEnd) : Math.min(inputValue.length, cursorPosition + 1);\n          setCursorPosition(newPos);\n          setSelectionStart(newPos);\n          setSelectionEnd(newPos);\n        }\n        break;\n\n      case 'Home':\n        if (e.shiftKey) {\n          setCursorPosition(0);\n          setSelectionEnd(0);\n        } else {\n          setCursorPosition(0);\n          setSelectionStart(0);\n          setSelectionEnd(0);\n        }\n        break;\n\n      case 'End':\n        if (e.shiftKey) {\n          setCursorPosition(inputValue.length);\n          setSelectionEnd(inputValue.length);\n        } else {\n          setCursorPosition(inputValue.length);\n          setSelectionStart(inputValue.length);\n          setSelectionEnd(inputValue.length);\n        }\n        break;\n\n      case 'a':\n        if (e.ctrlKey || e.metaKey) {\n          setSelectionStart(0);\n          setSelectionEnd(inputValue.length);\n          setCursorPosition(inputValue.length);\n        }\n        break;\n        \n      default:\n        if (e.key >= '0' && e.key <= '9') {\n          let newValue: string;\n          let newCursorPos: number;\n          \n          if (hasSelection) {\n            const start = Math.min(selectionStart, selectionEnd);\n            const end = Math.max(selectionStart, selectionEnd);\n            newValue = inputValue.slice(0, start) + e.key + inputValue.slice(end);\n            newCursorPos = start + 1;\n          } else {\n            newValue = inputValue.slice(0, cursorPosition) + e.key + inputValue.slice(cursorPosition);\n            newCursorPos = cursorPosition + 1;\n          }\n          \n          setInputValue(newValue);\n          setCursorPosition(newCursorPos);\n          setSelectionStart(newCursorPos);\n          setSelectionEnd(newCursorPos);\n        }\n    }\n  };\n\n  // Handle mouse events\n  const handleMouseDown = (e: React.MouseEvent) => {\n    const rect = e.currentTarget.getBoundingClientRect();\n    const x = e.clientX - rect.left;\n    \n    if (x <= EDGE_WIDTH || x >= rect.width - EDGE_WIDTH) {\n      setIsDragging(true);\n      setDragStart({ x: e.clientX, size: fontSize });\n      return;\n    }\n\n    const wasEditing = isEditing;\n    setIsEditing(true);\n    containerRef.current?.focus();\n    \n    if (!wasEditing) {\n      // First click from outside - select all\n      setSelectionStart(0);\n      setSelectionEnd(inputValue.length);\n      setCursorPosition(inputValue.length);\n    } else {\n      // Already editing - position cursor at click location\n      const clickX = x - 8 + scrollOffset; // Account for padding and scroll\n      const position = getCursorFromClick(clickX);\n      \n      setCursorPosition(position);\n      setSelectionStart(position);\n      setSelectionEnd(position);\n    }\n  };\n\n  // Handle double-click to select all\n  const handleDoubleClick = (e: React.MouseEvent) => {\n    const rect = e.currentTarget.getBoundingClientRect();\n    const x = e.clientX - rect.left;\n    \n    // Don't handle double-click on drag edges\n    if (x <= EDGE_WIDTH || x >= rect.width - EDGE_WIDTH) {\n      return;\n    }\n\n    setSelectionStart(0);\n    setSelectionEnd(inputValue.length);\n    setCursorPosition(inputValue.length);\n  };\n\n  // Keep cursor in bounds\n  useEffect(() => {\n    const maxPos = inputValue.length;\n    setCursorPosition(prev => Math.max(0, Math.min(maxPos, prev)));\n    setSelectionStart(prev => Math.max(0, Math.min(maxPos, prev)));\n    setSelectionEnd(prev => Math.max(0, Math.min(maxPos, prev)));\n  }, [inputValue]);\n\n  // Render text with selection highlighting\n  const renderText = () => {\n    if (!isEditing) {\n      return <span>{inputValue}</span>;\n    }\n\n    const hasSelection = selectionStart !== selectionEnd;\n    if (!hasSelection) {\n      return <span>{inputValue}</span>;\n    }\n\n    const start = Math.min(selectionStart, selectionEnd);\n    const end = Math.max(selectionStart, selectionEnd);\n    \n    return (\n      <>\n        <span>{inputValue.slice(0, start)}</span>\n        <span style={{ backgroundColor: '#0066cc', color: 'white' }}>\n          {inputValue.slice(start, end)}\n        </span>\n        <span>{inputValue.slice(end)}</span>\n      </>\n    );\n  };\n\n  const containerStyles = {\n    cursor: isDragging ? 'ew-resize' : 'text',\n  };\n\n  const textContainerStyles = {\n    position: 'relative' as const,\n    transform: `translateX(-${scrollOffset}px)`,\n    padding: '0 8px',\n    whiteSpace: 'nowrap' as const,\n    minWidth: '100%'\n  };\n\n  const cursorStyles = {\n    position: 'absolute' as const,\n    left: `${8 + getTextWidth(inputValue.slice(0, cursorPosition)) - scrollOffset}px`,\n    top: '5px',\n    width: '1px',\n    height: '14px',\n    backgroundColor: 'black',\n    animation: isEditing && selectionStart === selectionEnd ? 'blink 1s infinite' : 'none',\n    display: isEditing && selectionStart === selectionEnd ? 'block' : 'none'\n  };\n\n  return (\n    <>\n      <style>\n        {`\n          @keyframes blink {\n            0%, 50% { opacity: 1; }\n            51%, 100% { opacity: 0; }\n          }\n        `}\n      </style>\n      \n      <div style={{ display: 'flex', alignItems: 'center', gap: '2px' }}>\n        {/* Decrease Button */}\n        <button \n          className=\"button\"\n          onClick={() => updateFontSize(fontSize - 1)}\n        >\n          -\n        </button>\n        \n        {/* Fake Input Field */}\n        <div\n          ref={containerRef}\n          tabIndex={0}\n          onKeyDown={handleKeyDown}\n          onMouseDown={handleMouseDown}\n          onDoubleClick={handleDoubleClick}\n          onMouseMove={(e) => {\n            const rect = e.currentTarget.getBoundingClientRect();\n            const x = e.clientX - rect.left;\n            const onEdge = x <= EDGE_WIDTH || x >= rect.width - EDGE_WIDTH;\n            e.currentTarget.style.cursor = isDragging ? 'ew-resize' : (onEdge ? 'ew-resize' : 'text');\n          }}\n          className=\"font-size-input-container\"\n          style={containerStyles}\n        >\n          <div style={textContainerStyles}>\n            {renderText()}\n          </div>\n          <span style={cursorStyles}></span>\n          \n          {/* Hidden measurement span */}\n          <span \n            ref={measureRef}\n            style={{\n              position: 'absolute',\n              left: '-9999px',\n              fontSize: '16px',\n              fontFamily: 'monospace',\n              whiteSpace: 'pre'\n            }}\n          />\n        </div>\n        \n        {/* Increase Button */}\n        <button \n          className=\"button\"\n          onClick={() => updateFontSize(fontSize + 1)}\n        >\n          +\n        </button>\n      </div>\n    </>\n  );\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1818, "column": 0}, "map": {"version":3,"sources":["file:///Users/silsmaria/Projects/mathview/components/Editor/plugins/TextFormatting.tsx"],"sourcesContent":["import { useLexicalComposerContext } from \"@lexical/react/LexicalComposerContext\";\nimport {\n    $getSelection,\n    $isRangeSelection,\n    FORMAT_TEXT_COMMAND\n} from 'lexical';\nimport \"../styles.css\";\n\n\nexport default function TextFormatting() {\n    const [editor] = useLexicalComposerContext();\n\n    const applyFormat = (format: 'bold' | 'italic' | 'underline' | 'strikethrough') => {\n        editor.dispatchCommand(FORMAT_TEXT_COMMAND, format);\n    };\n\n    return (\n        <div style={{ display: 'flex', gap: '2px' }}>\n            <button className=\"button\" onClick={() => applyFormat('bold')}>B</button>\n            <button className=\"button\" onClick={() => applyFormat('italic')}>I</button>\n            <button className=\"button\" onClick={() => applyFormat('underline')}>U</button>\n            <button className=\"button\" onClick={() => applyFormat('strikethrough')}>S</button>\n        </div>\n    );\n} "],"names":[],"mappings":";;;;AAAA;AACA;;;;;AAQe,SAAS;IACpB,MAAM,CAAC,OAAO,GAAG,CAAA,GAAA,sUAAA,CAAA,4BAAyB,AAAD;IAEzC,MAAM,cAAc,CAAC;QACjB,OAAO,eAAe,CAAC,+LAAA,CAAA,sBAAmB,EAAE;IAChD;IAEA,qBACI,kYAAC;QAAI,OAAO;YAAE,SAAS;YAAQ,KAAK;QAAM;;0BACtC,kYAAC;gBAAO,WAAU;gBAAS,SAAS,IAAM,YAAY;0BAAS;;;;;;0BAC/D,kYAAC;gBAAO,WAAU;gBAAS,SAAS,IAAM,YAAY;0BAAW;;;;;;0BACjE,kYAAC;gBAAO,WAAU;gBAAS,SAAS,IAAM,YAAY;0BAAc;;;;;;0BACpE,kYAAC;gBAAO,WAAU;gBAAS,SAAS,IAAM,YAAY;0BAAkB;;;;;;;;;;;;AAGpF","debugId":null}},
    {"offset": {"line": 1888, "column": 0}, "map": {"version":3,"sources":["file:///Users/silsmaria/Projects/mathview/components/Editor/plugins/TextColor.tsx"],"sourcesContent":["import { useLexicalComposerContext } from \"@lexical/react/LexicalComposerContext\";\nimport { $getSelection, $isRangeSelection } from \"lexical\";\nimport { useState, useRef, useEffect } from \"react\";\nimport { HexColorPicker } from \"react-colorful\";\nimport \"../styles.css\";\n\nexport default function TextColor() {\n    const [editor] = useLexicalComposerContext();\n    const [isColorPickerOpen, setIsColorPickerOpen] = useState(false);\n    const [selectedColor, setSelectedColor] = useState('#000000');\n    const colorPickerRef = useRef<HTMLDivElement>(null);\n\n    useEffect(() => {\n        const handleClickOutside = (event: MouseEvent) => {\n          if (colorPickerRef.current && !colorPickerRef.current.contains(event.target as Node)) {\n            setIsColorPickerOpen(false);\n          }\n        };\n    \n        document.addEventListener('mousedown', handleClickOutside);\n        return () => {\n          document.removeEventListener('mousedown', handleClickOutside);\n        };\n      }, []);\n\n    const onTextColor = (color: string) => { \n        editor.update(() => {\n          const selection = $getSelection();\n          if ($isRangeSelection(selection)) {\n            $patchStyleText(selection, { color });\n          }\n        });\n      };\n\n    return (\n        <div style={{ position: 'relative' }}>\n        <button className=\"button\" onClick={() => setIsColorPickerOpen(!isColorPickerOpen)}>A</button>\n        {isColorPickerOpen && (\n          <div ref={colorPickerRef} style={{ position: 'absolute', top: '100%', left: '0', background: 'white', border: '1px solid #ccc', borderRadius: '4px', marginTop: '4px', boxShadow: '0 2px 4px rgba(0,0,0,0.1)', zIndex: 1000, padding: '8px' }}>\n            <HexColorPicker \n              color={selectedColor} \n              onChange={(color) => {\n                setSelectedColor(color);\n                onTextColor(color);\n              }} \n            />\n          </div>\n        )}\n      </div>\n    )\n} "],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;;;AAGe,SAAS;IACpB,MAAM,CAAC,OAAO,GAAG,CAAA,GAAA,sUAAA,CAAA,4BAAyB,AAAD;IACzC,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,CAAA,GAAA,yVAAA,CAAA,WAAQ,AAAD,EAAE;IAC3D,MAAM,CAAC,eAAe,iBAAiB,GAAG,CAAA,GAAA,yVAAA,CAAA,WAAQ,AAAD,EAAE;IACnD,MAAM,iBAAiB,CAAA,GAAA,yVAAA,CAAA,SAAM,AAAD,EAAkB;IAE9C,CAAA,GAAA,yVAAA,CAAA,YAAS,AAAD,EAAE;QACN,MAAM,qBAAqB,CAAC;YAC1B,IAAI,eAAe,OAAO,IAAI,CAAC,eAAe,OAAO,CAAC,QAAQ,CAAC,MAAM,MAAM,GAAW;gBACpF,qBAAqB;YACvB;QACF;QAEA,SAAS,gBAAgB,CAAC,aAAa;QACvC,OAAO;YACL,SAAS,mBAAmB,CAAC,aAAa;QAC5C;IACF,GAAG,EAAE;IAEP,MAAM,cAAc,CAAC;QACjB,OAAO,MAAM,CAAC;YACZ,MAAM,YAAY,CAAA,GAAA,+LAAA,CAAA,gBAAa,AAAD;YAC9B,IAAI,CAAA,GAAA,+LAAA,CAAA,oBAAiB,AAAD,EAAE,YAAY;gBAChC,gBAAgB,WAAW;oBAAE;gBAAM;YACrC;QACF;IACF;IAEF,qBACI,kYAAC;QAAI,OAAO;YAAE,UAAU;QAAW;;0BACnC,kYAAC;gBAAO,WAAU;gBAAS,SAAS,IAAM,qBAAqB,CAAC;0BAAoB;;;;;;YACnF,mCACC,kYAAC;gBAAI,KAAK;gBAAgB,OAAO;oBAAE,UAAU;oBAAY,KAAK;oBAAQ,MAAM;oBAAK,YAAY;oBAAS,QAAQ;oBAAkB,cAAc;oBAAO,WAAW;oBAAO,WAAW;oBAA6B,QAAQ;oBAAM,SAAS;gBAAM;0BAC1O,cAAA,kYAAC,8RAAA,CAAA,iBAAc;oBACb,OAAO;oBACP,UAAU,CAAC;wBACT,iBAAiB;wBACjB,YAAY;oBACd;;;;;;;;;;;;;;;;;AAMd","debugId":null}},
    {"offset": {"line": 1985, "column": 0}, "map": {"version":3,"sources":["file:///Users/silsmaria/Projects/mathview/components/Editor/plugins/Highlight.tsx"],"sourcesContent":["import { useLexicalComposerContext } from \"@lexical/react/LexicalComposerContext\";\nimport { $getSelection, $isRangeSelection } from \"lexical\";\nimport { $patchStyleText } from \"@lexical/selection\";\nimport { useState, useRef, useEffect } from \"react\";\nimport { HexColorPicker } from \"react-colorful\";\nimport \"../styles.css\";\n\nexport default function Highlight() {\n    const [editor] = useLexicalComposerContext();\n    const [isColorPickerOpen, setIsColorPickerOpen] = useState(false);\n    const [selectedColor, setSelectedColor] = useState('#ffffff');\n    const colorPickerRef = useRef<HTMLDivElement>(null);\n\n    useEffect(() => {\n        const handleClickOutside = (event: MouseEvent) => {\n          if (colorPickerRef.current && !colorPickerRef.current.contains(event.target as Node)) {\n            setIsColorPickerOpen(false);\n          }\n        };\n    \n        document.addEventListener('mousedown', handleClickOutside);\n        return () => {\n          document.removeEventListener('mousedown', handleClickOutside);\n        };\n      }, []);\n\n    const onHighlight = (color: string) => { \n        editor.update(() => {\n          const selection = $getSelection();\n          if ($isRangeSelection(selection)) {\n            $patchStyleText(selection, { 'background-color': color });\n          }\n        });\n      };\n\n    return (\n        <div style={{ position: 'relative' }}>\n        <button className=\"button\" onClick={() => setIsColorPickerOpen(!isColorPickerOpen)}>H</button>\n        {isColorPickerOpen && (\n          <div ref={colorPickerRef} style={{ position: 'absolute', top: '100%', left: '0', background: 'white', border: '1px solid #ccc', borderRadius: '4px', marginTop: '4px', boxShadow: '0 2px 4px rgba(0,0,0,0.1)', zIndex: 1000, padding: '8px' }}>\n            <HexColorPicker \n              color={selectedColor} \n              onChange={(color) => {\n                setSelectedColor(color);\n                onHighlight(color);\n              }} \n            />\n          </div>\n        )}\n      </div>\n    )\n} "],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;;;;;;;;AAGe,SAAS;IACpB,MAAM,CAAC,OAAO,GAAG,CAAA,GAAA,sUAAA,CAAA,4BAAyB,AAAD;IACzC,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,CAAA,GAAA,yVAAA,CAAA,WAAQ,AAAD,EAAE;IAC3D,MAAM,CAAC,eAAe,iBAAiB,GAAG,CAAA,GAAA,yVAAA,CAAA,WAAQ,AAAD,EAAE;IACnD,MAAM,iBAAiB,CAAA,GAAA,yVAAA,CAAA,SAAM,AAAD,EAAkB;IAE9C,CAAA,GAAA,yVAAA,CAAA,YAAS,AAAD,EAAE;QACN,MAAM,qBAAqB,CAAC;YAC1B,IAAI,eAAe,OAAO,IAAI,CAAC,eAAe,OAAO,CAAC,QAAQ,CAAC,MAAM,MAAM,GAAW;gBACpF,qBAAqB;YACvB;QACF;QAEA,SAAS,gBAAgB,CAAC,aAAa;QACvC,OAAO;YACL,SAAS,mBAAmB,CAAC,aAAa;QAC5C;IACF,GAAG,EAAE;IAEP,MAAM,cAAc,CAAC;QACjB,OAAO,MAAM,CAAC;YACZ,MAAM,YAAY,CAAA,GAAA,+LAAA,CAAA,gBAAa,AAAD;YAC9B,IAAI,CAAA,GAAA,+LAAA,CAAA,oBAAiB,AAAD,EAAE,YAAY;gBAChC,CAAA,GAAA,sPAAA,CAAA,kBAAe,AAAD,EAAE,WAAW;oBAAE,oBAAoB;gBAAM;YACzD;QACF;IACF;IAEF,qBACI,kYAAC;QAAI,OAAO;YAAE,UAAU;QAAW;;0BACnC,kYAAC;gBAAO,WAAU;gBAAS,SAAS,IAAM,qBAAqB,CAAC;0BAAoB;;;;;;YACnF,mCACC,kYAAC;gBAAI,KAAK;gBAAgB,OAAO;oBAAE,UAAU;oBAAY,KAAK;oBAAQ,MAAM;oBAAK,YAAY;oBAAS,QAAQ;oBAAkB,cAAc;oBAAO,WAAW;oBAAO,WAAW;oBAA6B,QAAQ;oBAAM,SAAS;gBAAM;0BAC1O,cAAA,kYAAC,8RAAA,CAAA,iBAAc;oBACb,OAAO;oBACP,UAAU,CAAC;wBACT,iBAAiB;wBACjB,YAAY;oBACd;;;;;;;;;;;;;;;;;AAMd","debugId":null}},
    {"offset": {"line": 2084, "column": 0}, "map": {"version":3,"sources":["file:///Users/silsmaria/Projects/mathview/components/Editor/plugins/List.tsx"],"sourcesContent":["import { useLexicalComposerContext } from \"@lexical/react/LexicalComposerContext\";\nimport { INSERT_ORDERED_LIST_COMMAND, INSERT_UNORDERED_LIST_COMMAND, ListType } from \"@lexical/list\";\nimport { useState, useRef, useEffect } from \"react\";\nimport \"../styles.css\";\n\nexport default function List() {\n  const [editor] = useLexicalComposerContext();\n  const [isListDropdownOpen, setIsListDropdownOpen] = useState(false);\n  const [selectedList, setSelectedList] = useState('None');\n  const dropdownRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setIsListDropdownOpen(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, []);\n\n  const onListClick = (tag: ListType): void => {\n    if(tag === 'number') {\n      editor.dispatchCommand(INSERT_ORDERED_LIST_COMMAND,undefined)\n    } else {\n      editor.dispatchCommand(INSERT_UNORDERED_LIST_COMMAND,undefined)\n    }\n  };\n  \n  return (\n    <div style={{ position: 'relative' }} ref={dropdownRef}>\n        <button\n          onClick={() => setIsListDropdownOpen(!isListDropdownOpen)}\n          className=\"dropdown\"\n        >\n          {selectedList}\n          <span style={{ fontSize: '12px' }}>▼</span>\n        </button>\n        {isListDropdownOpen && (\n          <div\n            style={{\n              position: 'absolute',\n              top: '100%',\n              left: '0',\n              background: 'white',\n              border: '1px solid #ccc',\n              borderRadius: '4px',\n              marginTop: '4px',\n              boxShadow: '0 2px 4px rgba(0,0,0,0.1)',\n              zIndex: 1000,\n              minWidth: '120px'\n            }}\n          >\n            {[\n              { text: 'None', action: () => setSelectedList('None') },\n              { text: 'Bullet List', action: () => { onListClick('bullet'); setSelectedList('Bullet List'); setIsListDropdownOpen(false); } },\n              { text: 'Numbered List', action: () => { onListClick('number'); setSelectedList('Numbered List'); setIsListDropdownOpen(false); } }\n            ].map((item, index) => (\n              <button\n                key={item.text}\n                style={{\n                  padding: '8px',\n                  width: '100%',\n                  textAlign: 'left',\n                  border: 'none',\n                  background: 'none',\n                  cursor: 'pointer',\n                  color: 'black',\n                  borderBottom: index < 2 ? '1px solid #eee' : 'none'\n                }}\n                onClick={() => {\n                  item.action();\n                  setIsListDropdownOpen(false);\n                }}\n              >\n                {item.text}\n              </button>\n            ))}\n          </div>\n        )}\n      </div>\n  );\n} "],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;AAGe,SAAS;IACtB,MAAM,CAAC,OAAO,GAAG,CAAA,GAAA,sUAAA,CAAA,4BAAyB,AAAD;IACzC,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,CAAA,GAAA,yVAAA,CAAA,WAAQ,AAAD,EAAE;IAC7D,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,yVAAA,CAAA,WAAQ,AAAD,EAAE;IACjD,MAAM,cAAc,CAAA,GAAA,yVAAA,CAAA,SAAM,AAAD,EAAkB;IAE3C,CAAA,GAAA,yVAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,qBAAqB,CAAC;YAC1B,IAAI,YAAY,OAAO,IAAI,CAAC,YAAY,OAAO,CAAC,QAAQ,CAAC,MAAM,MAAM,GAAW;gBAC9E,sBAAsB;YACxB;QACF;QAEA,SAAS,gBAAgB,CAAC,aAAa;QACvC,OAAO;YACL,SAAS,mBAAmB,CAAC,aAAa;QAC5C;IACF,GAAG,EAAE;IAEL,MAAM,cAAc,CAAC;QACnB,IAAG,QAAQ,UAAU;YACnB,OAAO,eAAe,CAAC,uNAAA,CAAA,8BAA2B,EAAC;QACrD,OAAO;YACL,OAAO,eAAe,CAAC,uNAAA,CAAA,gCAA6B,EAAC;QACvD;IACF;IAEA,qBACE,kYAAC;QAAI,OAAO;YAAE,UAAU;QAAW;QAAG,KAAK;;0BACvC,kYAAC;gBACC,SAAS,IAAM,sBAAsB,CAAC;gBACtC,WAAU;;oBAET;kCACD,kYAAC;wBAAK,OAAO;4BAAE,UAAU;wBAAO;kCAAG;;;;;;;;;;;;YAEpC,oCACC,kYAAC;gBACC,OAAO;oBACL,UAAU;oBACV,KAAK;oBACL,MAAM;oBACN,YAAY;oBACZ,QAAQ;oBACR,cAAc;oBACd,WAAW;oBACX,WAAW;oBACX,QAAQ;oBACR,UAAU;gBACZ;0BAEC;oBACC;wBAAE,MAAM;wBAAQ,QAAQ,IAAM,gBAAgB;oBAAQ;oBACtD;wBAAE,MAAM;wBAAe,QAAQ;4BAAQ,YAAY;4BAAW,gBAAgB;4BAAgB,sBAAsB;wBAAQ;oBAAE;oBAC9H;wBAAE,MAAM;wBAAiB,QAAQ;4BAAQ,YAAY;4BAAW,gBAAgB;4BAAkB,sBAAsB;wBAAQ;oBAAE;iBACnI,CAAC,GAAG,CAAC,CAAC,MAAM,sBACX,kYAAC;wBAEC,OAAO;4BACL,SAAS;4BACT,OAAO;4BACP,WAAW;4BACX,QAAQ;4BACR,YAAY;4BACZ,QAAQ;4BACR,OAAO;4BACP,cAAc,QAAQ,IAAI,mBAAmB;wBAC/C;wBACA,SAAS;4BACP,KAAK,MAAM;4BACX,sBAAsB;wBACxB;kCAEC,KAAK,IAAI;uBAhBL,KAAK,IAAI;;;;;;;;;;;;;;;;AAuB9B","debugId":null}},
    {"offset": {"line": 2219, "column": 0}, "map": {"version":3,"sources":["file:///Users/silsmaria/Projects/mathview/components/Editor/plugins/BannerPlugin.tsx"],"sourcesContent":["import { useLexicalComposerContext } from '@lexical/react/LexicalComposerContext';\nimport type {EditorConfig, LexicalNode, NodeKey} from 'lexical';\nimport {COMMAND_PRIORITY_LOW, createCommand, ElementNode, $getSelection, $isRangeSelection, $createParagraphNode} from 'lexical';\nimport {$setBlocksType} from '@lexical/selection';\n\nexport class BannerNode extends ElementNode {\n    static getType(): string{\n        return 'banner';\n    }\n\n    static clone(node: BannerNode):BannerNode{\n        return new BannerNode(node.__key);\n    }\n    createDOM(config: EditorConfig): HTMLElement{\n        const element = document.createElement('div')\n        element.className = config.theme.banner;\n\n        return element;       \n    }\n    updateDOM(prevNode: BannerNode, dom: HTMLElement): boolean{\n        return false;\n    }\n    collapseAtStart(): boolean{\n        const paragraph = $createParagraphNode();\n        const children = this.getChildren();\n        children.forEach(child=> paragraph.append(child));\n        this.replace(paragraph);\n        return true;\n    }\n   \n}\nexport function $createBannerNode(): BannerNode{\n    return new BannerNode();\n}\n    \n\nexport function $isBannerNode(node: LexicalNode): node is BannerNode{\n    return node instanceof BannerNode;\n}\n\nexport const INSERT_BANNER_COMMAND = createCommand('insertBanner');\n\nexport function BannerPlugin(): null{\n    const [editor] = useLexicalComposerContext();\n    if (!editor.hasNodes([BannerNode])){\n        throw new Error('BannerPlugin: BannerNode is not registered on the editor');\n    }\n    editor.registerCommand(INSERT_BANNER_COMMAND,() => {\n        const selection = $getSelection();\n        if ($isRangeSelection(selection)){\n            $setBlocksType(selection, $createBannerNode);\n        }\n        return true;\n    }, COMMAND_PRIORITY_LOW)\n    return null;\n}"],"names":[],"mappings":";;;;;;;AAAA;AAEA;AACA;;;;AAEO,MAAM,mBAAmB,+LAAA,CAAA,cAAW;IACvC,OAAO,UAAiB;QACpB,OAAO;IACX;IAEA,OAAO,MAAM,IAAgB,EAAY;QACrC,OAAO,IAAI,WAAW,KAAK,KAAK;IACpC;IACA,UAAU,MAAoB,EAAc;QACxC,MAAM,UAAU,SAAS,aAAa,CAAC;QACvC,QAAQ,SAAS,GAAG,OAAO,KAAK,CAAC,MAAM;QAEvC,OAAO;IACX;IACA,UAAU,QAAoB,EAAE,GAAgB,EAAU;QACtD,OAAO;IACX;IACA,kBAA0B;QACtB,MAAM,YAAY,CAAA,GAAA,+LAAA,CAAA,uBAAoB,AAAD;QACrC,MAAM,WAAW,IAAI,CAAC,WAAW;QACjC,SAAS,OAAO,CAAC,CAAA,QAAQ,UAAU,MAAM,CAAC;QAC1C,IAAI,CAAC,OAAO,CAAC;QACb,OAAO;IACX;AAEJ;AACO,SAAS;IACZ,OAAO,IAAI;AACf;AAGO,SAAS,cAAc,IAAiB;IAC3C,OAAO,gBAAgB;AAC3B;AAEO,MAAM,wBAAwB,CAAA,GAAA,+LAAA,CAAA,gBAAa,AAAD,EAAE;AAE5C,SAAS;IACZ,MAAM,CAAC,OAAO,GAAG,CAAA,GAAA,sUAAA,CAAA,4BAAyB,AAAD;IACzC,IAAI,CAAC,OAAO,QAAQ,CAAC;QAAC;KAAW,GAAE;QAC/B,MAAM,IAAI,MAAM;IACpB;IACA,OAAO,eAAe,CAAC,uBAAsB;QACzC,MAAM,YAAY,CAAA,GAAA,+LAAA,CAAA,gBAAa,AAAD;QAC9B,IAAI,CAAA,GAAA,+LAAA,CAAA,oBAAiB,AAAD,EAAE,YAAW;YAC7B,CAAA,GAAA,sPAAA,CAAA,iBAAc,AAAD,EAAE,WAAW;QAC9B;QACA,OAAO;IACX,GAAG,+LAAA,CAAA,uBAAoB;IACvB,OAAO;AACX","debugId":null}},
    {"offset": {"line": 2284, "column": 0}, "map": {"version":3,"sources":["file:///Users/silsmaria/Projects/mathview/components/Editor/ToolBar.tsx"],"sourcesContent":["import UndoRedo from \"./plugins/UndoRedo\";\nimport TextFormat from \"./plugins/BlockType\";\nimport Font from \"./plugins/Font\";\nimport FontSize from \"./plugins/FontSize\";\nimport TextFormatting from \"./plugins/TextFormatting\";\nimport TextColor from \"./plugins/TextColor\";\nimport Highlight from \"./plugins/Highlight\";\nimport Alignment from \"./plugins/Alignment\";\nimport List from \"./plugins/List\";\nimport { useLexicalComposerContext } from \"@lexical/react/LexicalComposerContext\";\nimport { INSERT_BANNER_COMMAND } from \"./plugins/BannerPlugin\";\nimport { JSX } from \"react\";\nimport \"@/components/Editor/styles.css\";\n\n\nfunction BannertoolbarPlugin(): JSX.Element{\n    const [editor] = useLexicalComposerContext();\n    const onClick = (e: React.MouseEvent) => {\n        editor.dispatchCommand(INSERT_BANNER_COMMAND, undefined);\n    }\n    return (\n        <button className=\"button\" onClick={onClick}>Banner</button>\n    )\n}\n\nexport default function Toolbar() {\n    return (\n        <div className=\"toolbar\" style={{backgroundColor: 'white', display: 'flex', gap: '0.5rem', padding: '8px', borderBottom: '1px solid #eee' }}>\n            <UndoRedo />\n            <TextFormat />\n            <Font />\n            <FontSize />\n            <TextFormatting />\n            <TextColor />\n            <Highlight />\n            {/* <Alignment /> */}\n            <List />\n            <BannertoolbarPlugin />\n        </div>\n    )\n}"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;;;;;;;;;;;;;AAKA,SAAS;IACL,MAAM,CAAC,OAAO,GAAG,CAAA,GAAA,sUAAA,CAAA,4BAAyB,AAAD;IACzC,MAAM,UAAU,CAAC;QACb,OAAO,eAAe,CAAC,gJAAA,CAAA,wBAAqB,EAAE;IAClD;IACA,qBACI,kYAAC;QAAO,WAAU;QAAS,SAAS;kBAAS;;;;;;AAErD;AAEe,SAAS;IACpB,qBACI,kYAAC;QAAI,WAAU;QAAU,OAAO;YAAC,iBAAiB;YAAS,SAAS;YAAQ,KAAK;YAAU,SAAS;YAAO,cAAc;QAAiB;;0BACtI,kYAAC,4IAAA,CAAA,UAAQ;;;;;0BACT,kYAAC,6IAAA,CAAA,UAAU;;;;;0BACX,kYAAC,wIAAA,CAAA,UAAI;;;;;0BACL,kYAAC,4IAAA,CAAA,UAAQ;;;;;0BACT,kYAAC,kJAAA,CAAA,UAAc;;;;;0BACf,kYAAC,6IAAA,CAAA,UAAS;;;;;0BACV,kYAAC,6IAAA,CAAA,UAAS;;;;;0BAEV,kYAAC,wIAAA,CAAA,UAAI;;;;;0BACL,kYAAC;;;;;;;;;;;AAGb","debugId":null}},
    {"offset": {"line": 2394, "column": 0}, "map": {"version":3,"sources":["file:///Users/silsmaria/Projects/mathview/components/Editor/plugins/SpacerNode.tsx"],"sourcesContent":["import type { NodeKey, SerializedLexicalNode } from 'lexical'\nimport { DecoratorNode } from 'lexical'\nimport React from 'react'\n\nexport type SerializedSpacerNode = SerializedLexicalNode & {\n  height: number\n  mathKey: string\n}\n\nexport class SpacerNode extends DecoratorNode<JSX.Element> {\n  __height: number\n  __mathKey: string\n\n  static getType(): string {\n    return 'math-spacer'\n  }\n\n  static clone(node: SpacerNode): SpacerNode {\n    return new SpacerNode(node.__height, node.__mathKey, node.__key)\n  }\n\n  static importJSON(serializedNode: SerializedSpacerNode): SpacerNode {\n    const node = new SpacerNode(serializedNode.height, serializedNode.mathKey)\n    return node\n  }\n\n  exportJSON(): SerializedSpacerNode {\n    return {\n      ...super.exportJSON(),\n      height: this.__height,\n      mathKey: this.__mathKey,\n      type: SpacerNode.getType(),\n      version: 1,\n    }\n  }\n\n  constructor(height: number, mathKey: string, key?: NodeKey) {\n    super(key)\n    this.__height = height\n    this.__mathKey = mathKey\n  }\n\n  setHeight(next: number) {\n    const writable = this.getWritable<SpacerNode>()\n    writable.__height = next\n  }\n\n  getHeight(): number {\n    return this.getLatest<SpacerNode>().__height\n  }\n\n  getMathKey(): string {\n    return this.getLatest<SpacerNode>().__mathKey\n  }\n\n  createDOM(): HTMLElement {\n    const el = document.createElement('div')\n    el.setAttribute('data-lexical-math-spacer', 'true')\n    el.setAttribute('data-for', this.__mathKey)\n    el.style.height = `${Math.max(0, Math.round(this.__height))}px`\n    el.style.display = 'block'\n    el.style.width = '100%'\n    el.style.pointerEvents = 'none'\n    el.style.lineHeight = '0'\n    return el\n  }\n\n  updateDOM(dom: HTMLElement): boolean {\n    dom.setAttribute('data-for', this.__mathKey)\n    dom.style.height = `${Math.max(0, Math.round(this.__height))}px`\n    return false\n  }\n\n  decorate(): JSX.Element {\n    // DOM is enough; no React needed\n    return <></>\n  }\n}\n\nexport function $createSpacerNode(height: number, mathKey: string): SpacerNode {\n  return new SpacerNode(height, mathKey)\n}\n\nexport function $isSpacerNode(node: unknown): node is SpacerNode {\n  return node instanceof SpacerNode\n}\n\n\n"],"names":[],"mappings":";;;;;;AACA;;;AAQO,MAAM,mBAAmB,+LAAA,CAAA,gBAAa;IAC3C,SAAgB;IAChB,UAAiB;IAEjB,OAAO,UAAkB;QACvB,OAAO;IACT;IAEA,OAAO,MAAM,IAAgB,EAAc;QACzC,OAAO,IAAI,WAAW,KAAK,QAAQ,EAAE,KAAK,SAAS,EAAE,KAAK,KAAK;IACjE;IAEA,OAAO,WAAW,cAAoC,EAAc;QAClE,MAAM,OAAO,IAAI,WAAW,eAAe,MAAM,EAAE,eAAe,OAAO;QACzE,OAAO;IACT;IAEA,aAAmC;QACjC,OAAO;YACL,GAAG,KAAK,CAAC,YAAY;YACrB,QAAQ,IAAI,CAAC,QAAQ;YACrB,SAAS,IAAI,CAAC,SAAS;YACvB,MAAM,WAAW,OAAO;YACxB,SAAS;QACX;IACF;IAEA,YAAY,MAAc,EAAE,OAAe,EAAE,GAAa,CAAE;QAC1D,KAAK,CAAC;QACN,IAAI,CAAC,QAAQ,GAAG;QAChB,IAAI,CAAC,SAAS,GAAG;IACnB;IAEA,UAAU,IAAY,EAAE;QACtB,MAAM,WAAW,IAAI,CAAC,WAAW;QACjC,SAAS,QAAQ,GAAG;IACtB;IAEA,YAAoB;QAClB,OAAO,IAAI,CAAC,SAAS,GAAe,QAAQ;IAC9C;IAEA,aAAqB;QACnB,OAAO,IAAI,CAAC,SAAS,GAAe,SAAS;IAC/C;IAEA,YAAyB;QACvB,MAAM,KAAK,SAAS,aAAa,CAAC;QAClC,GAAG,YAAY,CAAC,4BAA4B;QAC5C,GAAG,YAAY,CAAC,YAAY,IAAI,CAAC,SAAS;QAC1C,GAAG,KAAK,CAAC,MAAM,GAAG,GAAG,KAAK,GAAG,CAAC,GAAG,KAAK,KAAK,CAAC,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;QAC/D,GAAG,KAAK,CAAC,OAAO,GAAG;QACnB,GAAG,KAAK,CAAC,KAAK,GAAG;QACjB,GAAG,KAAK,CAAC,aAAa,GAAG;QACzB,GAAG,KAAK,CAAC,UAAU,GAAG;QACtB,OAAO;IACT;IAEA,UAAU,GAAgB,EAAW;QACnC,IAAI,YAAY,CAAC,YAAY,IAAI,CAAC,SAAS;QAC3C,IAAI,KAAK,CAAC,MAAM,GAAG,GAAG,KAAK,GAAG,CAAC,GAAG,KAAK,KAAK,CAAC,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;QAChE,OAAO;IACT;IAEA,WAAwB;QACtB,iCAAiC;QACjC,qBAAO;IACT;AACF;AAEO,SAAS,kBAAkB,MAAc,EAAE,OAAe;IAC/D,OAAO,IAAI,WAAW,QAAQ;AAChC;AAEO,SAAS,cAAc,IAAa;IACzC,OAAO,gBAAgB;AACzB","debugId":null}},
    {"offset": {"line": 2473, "column": 0}, "map": {"version":3,"sources":["file:///Users/silsmaria/Projects/mathview/components/Editor/plugins/MathNode.tsx"],"sourcesContent":["import { useLexicalComposerContext } from '@lexical/react/LexicalComposerContext';\nimport type { LexicalNode, NodeKey, SerializedLexicalNode } from 'lexical';\nimport { createCommand, DecoratorNode, $getSelection, COMMAND_PRIORITY_LOW, $createRangeSelection, $setSelection, $isRangeSelection, $getNodeByKey, $createNodeSelection, $createParagraphNode, ParagraphNode } from 'lexical';\nimport React, { useRef, useEffect, useState } from 'react';\nimport MathEditor, { MathEditorAPI } from '@/components/mathview/MathEditor';\nimport { useLexicalNodeSelection } from '@lexical/react/useLexicalNodeSelection';\nimport { $createSpacerNode, $isSpacerNode } from './SpacerNode';\n\n// Serialized type for the MathNode\nexport type SerializedMathNode = SerializedLexicalNode;\n\nlet initMathString = \"\";\nexport class MathNode extends DecoratorNode<React.ReactElement> {\n\n  static getType(): string {\n    return 'math';\n  }\n\n  static clone(node: MathNode): MathNode {\n    return new MathNode(node.__key);\n  }\n\n  static importJSON(serializedNode: SerializedMathNode): MathNode {\n    return new MathNode();\n  }\n\n  constructor(key?: NodeKey) {\n    super(key);\n  }\n\n  exportJSON(): SerializedMathNode {\n    return {\n      ...super.exportJSON(),\n    };\n  }\n\n  createDOM(): HTMLElement {\n    const element = document.createElement('div');\n    element.className = 'math-node-container';\n    element.style.display = 'inline-block';\n    element.style.verticalAlign = 'bottom';\n    return element;\n  }\n\n  updateDOM(): boolean {\n    return false;\n  }\n\n  decorate(): React.ReactElement {\n    return <MathNodeComponent nodeKey={this.__key}/>;\n  }\n}\n\n// React component wrapper for the MathEditor\nfunction MathNodeComponent({ nodeKey }: { nodeKey: string }) {\n  const [editor] = useLexicalComposerContext();\n  const mathEditorRef = useRef<MathEditorAPI>(null);\n  const hasInsertedRef = useRef(false);\n  const [isSelected, setSelected, clearSelection] = useLexicalNodeSelection(nodeKey);\n\n  // Effect to handle selection changes\n  useEffect(() => {\n    if (isSelected) {\n      console.log('MathNode SELECTED via useLexicalNodeSelection');\n      if (mathEditorRef.current) {\n        mathEditorRef.current.focus();\n      }\n    }\n  }, [isSelected]);\n\n  // Listen for measured overflow from MathRender and restructure the document using a spacer paragraph\n  useEffect(() => {\n    const handler = (event: Event) => {\n      const detail = (event as CustomEvent<{ nodeKey: string; extraPx: number }>).detail;\n      if (!detail || detail.nodeKey !== nodeKey) return;\n      const extra = Math.max(0, Math.round(detail.extraPx || 0));\n\n      editor.update(() => {\n        const mathNode = $getNodeByKey(nodeKey);\n        if (!mathNode) return;\n        const parent = mathNode.getParent();\n        if (!parent) return;\n\n        // We operate at the paragraph level\n        const paragraph = parent as ParagraphNode;\n        const afterParent = paragraph.getNextSibling();\n\n        // Helper to detect spacer paragraph right after current paragraph\n        const isSpacerParagraphForThisMath = (node: LexicalNode | null | undefined): boolean => {\n          if (!node || (node as any).getType?.() !== 'paragraph') return false;\n          const firstChild = (node as ParagraphNode).getFirstChild();\n          return !!firstChild && $isSpacerNode(firstChild) && firstChild.getMathKey() === nodeKey;\n        };\n\n        if (extra > 0) {\n          // Ensure spacer paragraph exists and has correct height\n          if (!isSpacerParagraphForThisMath(afterParent)) {\n            // Create a new paragraph to hold spacer\n            const spacerPara = $createParagraphNode();\n            const spacer = $createSpacerNode(extra, nodeKey);\n            spacerPara.append(spacer);\n\n            // Move following siblings of the current paragraph into a new paragraph\n            const newPara = $createParagraphNode();\n            while (paragraph.getNextSibling()) {\n              const sib = paragraph.getNextSibling();\n              if (!sib) break;\n              newPara.append(sib);\n            }\n\n            // Insert spacer and the new content paragraph after the current paragraph\n            paragraph.insertAfter(spacerPara);\n            spacerPara.insertAfter(newPara);\n          } else {\n            // Update existing spacer height\n            const spacerPara = afterParent as ParagraphNode;\n            const spacer = spacerPara.getFirstChild();\n            if (spacer && $isSpacerNode(spacer)) {\n              spacer.setHeight(extra);\n            }\n          }\n        } else {\n          // Remove spacer paragraph and merge content back\n          if (isSpacerParagraphForThisMath(afterParent)) {\n            const spacerPara = afterParent as ParagraphNode;\n            const contentPara = spacerPara.getNextSibling();\n            // Remove spacer paragraph\n            spacerPara.remove();\n            // Move content back into current paragraph and remove the extra paragraph\n            if (contentPara && (contentPara as any).getType?.() === 'paragraph') {\n              while ((contentPara as ParagraphNode).getFirstChild()) {\n                const child = (contentPara as ParagraphNode).getFirstChild();\n                if (!child) break;\n                paragraph.append(child);\n              }\n              (contentPara as ParagraphNode).remove();\n            }\n          }\n        }\n      });\n    };\n\n    document.addEventListener('math-overflow', handler as EventListener);\n    return () => document.removeEventListener('math-overflow', handler as EventListener);\n  }, [editor, nodeKey]);\n\n           // Effect to listen for math navigation events\n         useEffect(() => {\n           const handleMathNavigation = (event: CustomEvent) => {\n             const detail = (event as CustomEvent<{ nodeKey?: string }>).detail;\n             if (!detail || detail.nodeKey !== nodeKey) return;\n\n             const isLeft = event.type === 'math-navigate-left';\n             const isRight = event.type === 'math-navigate-right';\n             if (!isLeft && !isRight) return;\n\n             editor.update(() => {\n               const node = $getNodeByKey(nodeKey);\n               if (!node) return;\n               const parent = node.getParent();\n               if (!parent) return;\n\n               const indexWithinParent = node.getIndexWithinParent();\n               const offset = isLeft ? indexWithinParent : indexWithinParent + 1;\n\n               const range = $createRangeSelection();\n               range.anchor.set(parent.getKey(), offset, 'element');\n               range.focus.set(parent.getKey(), offset, 'element');\n               $setSelection(range);\n             });\n           };\n\n           document.addEventListener('math-navigate-left', handleMathNavigation as EventListener);\n           document.addEventListener('math-navigate-right', handleMathNavigation as EventListener);\n\n           return () => {\n             document.removeEventListener('math-navigate-left', handleMathNavigation as EventListener);\n             document.removeEventListener('math-navigate-right', handleMathNavigation as EventListener);\n           };\n         }, [editor, nodeKey]);\n\n  // Effect to insert the detected math string when the component mounts\n  useEffect(() => {\n    console.log('MathNodeComponent effect running, initMathString:', initMathString, 'mathEditorRef.current:', mathEditorRef.current);\n    \n    if (initMathString && mathEditorRef.current && !hasInsertedRef.current) {\n      // Insert each character from the detected math string\n      for (let i = 0; i < initMathString.length; i++) {\n        console.log('Inserting character:', initMathString[i]);\n        mathEditorRef.current.insert(initMathString[i]);\n      }\n      \n      hasInsertedRef.current = true;\n      console.log('Insertion completed, hasInserted set to true');\n    }\n    \n    // Always focus the MathEditor when component mounts\n    setTimeout(() => {\n      console.log('Attempting to focus MathEditor, ref available:', mathEditorRef.current);\n      if (mathEditorRef.current) {\n        mathEditorRef.current.focus();\n        console.log('Focus called on MathEditor');\n      }\n    }, 50);\n  }, []);\n\n  const handleClick = (e: React.MouseEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    editor.update(() => {\n      const nodeSelection = $createNodeSelection();\n      nodeSelection.add(nodeKey);\n      $setSelection(nodeSelection);\n    });\n  };\n\n  return (\n    <div \n      data-lexical-math-editor\n      onClick={handleClick}\n    >\n      <MathEditor ref={mathEditorRef} nodeKey={nodeKey} />\n    </div>\n  );\n}\n\n// Utility function to get MathEditor API from a MathNode\nexport function getMathEditorAPI(nodeKey: string): MathEditorAPI | null {\n  return null; // No longer needed\n}\n\n// Utility functions\nexport function $createMathNode(): MathNode {\n  return new MathNode();\n}\n\nexport function $isMathNode(node: LexicalNode | null | undefined): node is MathNode {\n  return node instanceof MathNode;\n}\n\n// Command to insert math node\nexport const INSERT_MATH_COMMAND = createCommand<{ replace?: string }>('insertMath');\n\n// Plugin to register the command\nexport function MathNodePlugin(): null {\n  const [editor] = useLexicalComposerContext();\n  \n  if (!editor.hasNodes([MathNode])) {\n    throw new Error('MathNodePlugin: MathNode is not registered on the editor');\n  }\n\n  editor.registerCommand(\n    INSERT_MATH_COMMAND,\n    (payload) => {\n      // If replace string is provided, delete it from Lexical first\n      if (payload?.replace) {\n        deleteMathString(editor, payload.replace);\n      }\n      \n      editor.update(() => {\n        const mathNode = $createMathNode();\n        const selection = $getSelection();\n        if (selection) {\n          selection.insertNodes([mathNode]);\n          \n          // Set the global variable for the MathNodeComponent to use\n          if (payload?.replace) {\n            initMathString = payload.replace;\n          }\n          \n          // Clear the selection in the Lexical editor\n          $setSelection(null);\n        }\n      });\n      return true;\n    },\n    COMMAND_PRIORITY_LOW\n  );\n\n  return null;\n}\n\n// Function to delete math string from Lexical\nexport function deleteMathString(editor: any, replace: string) {\n  editor.update(() => {\n    const selection = $getSelection();\n    if (selection && $isRangeSelection(selection)) {\n      const anchor = selection.anchor;\n      const focus = selection.focus;\n      \n      // Ensure we don't go out of bounds\n      const startOffset = Math.max(0, anchor.offset - replace.length);\n      \n      // Create a selection that starts 'replace.length' characters behind the current position\n      const newSelection = $createRangeSelection();\n      newSelection.anchor.set(anchor.key, startOffset, anchor.type);\n      newSelection.focus.set(focus.key, focus.offset, focus.type);\n      \n      $setSelection(newSelection);\n      \n      // Delete the selected content\n      newSelection.removeText();\n    }\n  });\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2766, "column": 0}, "map": {"version":3,"sources":["file:///Users/silsmaria/Projects/mathview/components/Editor/plugins/MathParser.tsx"],"sourcesContent":["import { useLexicalComposerContext } from \"@lexical/react/LexicalComposerContext\";\nimport { useEffect } from \"react\";\nimport { $getRoot, $getSelection, $isRangeSelection } from \"lexical\";\nimport { INSERT_MATH_COMMAND } from \"./MathNode\";\n\nexport function MathParserPlugin() {\n  const [editor] = useLexicalComposerContext();\n\n  useEffect(() => {\n    const registerUpdateListener = editor.registerUpdateListener(({ editorState }) => {\n      editorState.read(() => {\n        const root = $getRoot();\n        const text = root.getTextContent();\n\n        // Regex pattern for incomplete mathematical expressions\n        // Matches: numbers/variables + operators (incomplete expressions)\n        // Examples: a+, 6^, f=, 2+, etc.\n        const mathRegex = /([a-zA-Z0-9]+[\\+\\-\\*\\/\\^=])(?=\\s|$)/g;\n        const matches = text.match(mathRegex);\n\n        if (matches && matches.length > 0) {\n          console.log('Math detected:', matches);\n          // Trigger the command to insert MathNode with the detected math text\n          editor.dispatchCommand(INSERT_MATH_COMMAND, { replace: matches[0] });\n        }\n      });\n    });\n    return registerUpdateListener;\n  }, [editor]);\n\n  return null;\n}"],"names":[],"mappings":";;;AAAA;AACA;AACA;AACA;;;;;AAEO,SAAS;IACd,MAAM,CAAC,OAAO,GAAG,CAAA,GAAA,sUAAA,CAAA,4BAAyB,AAAD;IAEzC,CAAA,GAAA,yVAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,yBAAyB,OAAO,sBAAsB,CAAC,CAAC,EAAE,WAAW,EAAE;YAC3E,YAAY,IAAI,CAAC;gBACf,MAAM,OAAO,CAAA,GAAA,+LAAA,CAAA,WAAQ,AAAD;gBACpB,MAAM,OAAO,KAAK,cAAc;gBAEhC,wDAAwD;gBACxD,kEAAkE;gBAClE,iCAAiC;gBACjC,MAAM,YAAY;gBAClB,MAAM,UAAU,KAAK,KAAK,CAAC;gBAE3B,IAAI,WAAW,QAAQ,MAAM,GAAG,GAAG;oBACjC,QAAQ,GAAG,CAAC,kBAAkB;oBAC9B,qEAAqE;oBACrE,OAAO,eAAe,CAAC,4IAAA,CAAA,sBAAmB,EAAE;wBAAE,SAAS,OAAO,CAAC,EAAE;oBAAC;gBACpE;YACF;QACF;QACA,OAAO;IACT,GAAG;QAAC;KAAO;IAEX,OAAO;AACT","debugId":null}},
    {"offset": {"line": 2810, "column": 0}, "map": {"version":3,"sources":["file:///Users/silsmaria/Projects/mathview/components/Editor/Editor.tsx"],"sourcesContent":["\"use client\";\nimport {LexicalComposer} from '@lexical/react/LexicalComposer';\nimport {RichTextPlugin} from '@lexical/react/LexicalRichTextPlugin';\nimport {ContentEditable} from '@lexical/react/LexicalContentEditable';\nimport {HistoryPlugin} from '@lexical/react/LexicalHistoryPlugin';\nimport {LexicalErrorBoundary} from '@lexical/react/LexicalErrorBoundary';\nimport '@/styles/editor.css';\nimport {HeadingNode} from '@lexical/rich-text';\nimport {ListPlugin} from '@lexical/react/LexicalListPlugin';\nimport {\n  ListNode, \n  ListItemNode, \n} from '@lexical/list';\nimport Toolbar from './ToolBar';\nimport { BannerNode, BannerPlugin } from './plugins/BannerPlugin';\nimport { MathParserPlugin } from './plugins/MathParser';\nimport { TreeView } from '@lexical/react/LexicalTreeView';\nimport { useLexicalComposerContext } from '@lexical/react/LexicalComposerContext';\nimport { MathNode, MathNodePlugin } from './plugins/MathNode';\nimport { SpacerNode } from './plugins/SpacerNode';\n\nconst theme = {\n  heading: {\n    h1: 'text-2xl font-bold',\n    h2: 'text-xl font-bold',\n    h3: 'text-lg font-bold'\n  },\n  text: {\n    bold: 'font-bold',\n    italic: 'italic',\n    underline: 'underline'\n  },\n  list: {\n    ol: 'list-decimal pl-5',\n    ul: 'list-disc pl-5'\n  },\n  banner: 'bg-blue-500 text-white p-2 rounded-md'\n};\n\nfunction onError(error: Error) {\n  console.error(error);\n}\n\nfunction TreeViewWrapper() {\n  const [editor] = useLexicalComposerContext();\n  return <TreeView editor={editor} />;\n}\n\nexport default function Editor() {\n  const initialConfig = {\n    namespace: 'MyEditor',\n    theme,\n    onError,\n    nodes: [HeadingNode, ListNode, ListItemNode, BannerNode, MathNode, SpacerNode],\n  };\n\n  return (\n    <LexicalComposer initialConfig={initialConfig}>\n      <div style={{display: 'flex', alignItems: 'flex-start'}}>\n      <MathParserPlugin />\n      <MathNodePlugin />\n\n      <div className=\"editor-container\">\n        <Toolbar/>\n        <ListPlugin />\n        <HistoryPlugin />\n        <BannerPlugin />\n        <RichTextPlugin\n          contentEditable={\n            <ContentEditable\n              className=\"editor-input\"\n            />\n          }\n          placeholder={<div>Enter some text...</div>}\n          ErrorBoundary={LexicalErrorBoundary}\n        />\n      </div>\n      <TreeViewWrapper />\n      </div>\n    </LexicalComposer>\n    \n  );\n}"],"names":[],"mappings":";;;;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AAnBA;;;;;;;;;;;;;;;;;;AAqBA,MAAM,QAAQ;IACZ,SAAS;QACP,IAAI;QACJ,IAAI;QACJ,IAAI;IACN;IACA,MAAM;QACJ,MAAM;QACN,QAAQ;QACR,WAAW;IACb;IACA,MAAM;QACJ,IAAI;QACJ,IAAI;IACN;IACA,QAAQ;AACV;AAEA,SAAS,QAAQ,KAAY;IAC3B,QAAQ,KAAK,CAAC;AAChB;AAEA,SAAS;IACP,MAAM,CAAC,OAAO,GAAG,CAAA,GAAA,sUAAA,CAAA,4BAAyB,AAAD;IACzC,qBAAO,kYAAC,+TAAA,CAAA,WAAQ;QAAC,QAAQ;;;;;;AAC3B;AAEe,SAAS;IACtB,MAAM,gBAAgB;QACpB,WAAW;QACX;QACA;QACA,OAAO;YAAC,2OAAA,CAAA,cAAW;YAAE,uNAAA,CAAA,WAAQ;YAAE,uNAAA,CAAA,eAAY;YAAE,gJAAA,CAAA,aAAU;YAAE,4IAAA,CAAA,WAAQ;YAAE,8IAAA,CAAA,aAAU;SAAC;IAChF;IAEA,qBACE,kYAAC,+TAAA,CAAA,kBAAe;QAAC,eAAe;kBAC9B,cAAA,kYAAC;YAAI,OAAO;gBAAC,SAAS;gBAAQ,YAAY;YAAY;;8BACtD,kYAAC,8IAAA,CAAA,mBAAgB;;;;;8BACjB,kYAAC,4IAAA,CAAA,iBAAc;;;;;8BAEf,kYAAC;oBAAI,WAAU;;sCACb,kYAAC,gIAAA,CAAA,UAAO;;;;;sCACR,kYAAC,iUAAA,CAAA,aAAU;;;;;sCACX,kYAAC,oVAAA,CAAA,gBAAa;;;;;sCACd,kYAAC,gJAAA,CAAA,eAAY;;;;;sCACb,kYAAC,qUAAA,CAAA,iBAAc;4BACb,+BACE,kYAAC,sUAAA,CAAA,kBAAe;gCACd,WAAU;;;;;;4BAGd,2BAAa,kYAAC;0CAAI;;;;;;4BAClB,eAAe,oUAAA,CAAA,uBAAoB;;;;;;;;;;;;8BAGvC,kYAAC;;;;;;;;;;;;;;;;AAKP","debugId":null}}]
}